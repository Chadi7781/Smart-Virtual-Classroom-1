{"ast":null,"code":"import { createAsyncThunk, createSlice } from \"@reduxjs/toolkit\";\nimport axios from \"axios\";\nexport const getNbrTasksRemis = createAsyncThunk(\"Task/getNbrTasksRemis\", async id => {\n  const {\n    data\n  } = await axios.get(`http://localhost:5000/task/StatTaskRemis/${id}`);\n  return data;\n});\nexport const getNbrTasksMissing = createAsyncThunk(\"Task/getNbrTasksMissing\", async id => {\n  const {\n    data\n  } = await axios.get(`http://localhost:5000/task/StatTaskMissing/${id}`);\n  return data;\n});\nexport const getTaskByTeacher = createAsyncThunk(\"Task/getTaskByTeacher\", async taskDetail => {\n  console.log(taskDetail);\n  const {\n    data\n  } = await axios.get(`https://closer-server.herokuapp.com/task/teacher?idUser=${taskDetail.idUser}&idClass=${taskDetail.idClass}`);\n  return data;\n});\nexport const getDetailTask = createAsyncThunk(\"Task/getDetailTasks\", async id => {\n  const {\n    data\n  } = await axios.get(`https://closer-server.herokuapp.com/task/DetailTask/${id}`);\n  return data;\n});\nexport const getTasks = createAsyncThunk(\"Task/getTasks\", async () => {\n  const {\n    data\n  } = await axios.get(\"https://closer-server.herokuapp.com/task\");\n  return data;\n});\nexport const assignTask = createAsyncThunk(\"Task/assignTask\", async task => {\n  const {\n    response\n  } = await axios.post(\"https://closer-server.herokuapp.com/task/assign\", task);\n  return response.data;\n});\nexport const postTasks = createAsyncThunk(\"Task/postTask\", async task => {\n  const {\n    response\n  } = await axios.post(\"https://closer-server.herokuapp.com/task\", task);\n  return response.data;\n});\n/*upload file add */\n\nexport const addUploadFile = createAsyncThunk(\"Task/addUploadFile\", async files => {\n  var formData = new FormData();\n\n  for (const key of Object.keys(files)) {\n    formData.append(\"multiple_resources\", files[key]);\n  }\n\n  const response = await axios.post(\"https://closer-server.herokuapp.com/task/uploadFile\", formData);\n  console.log(response.data);\n  return response.data;\n});\n/*upload file */\n\nexport const uploadFile = createAsyncThunk(\"Task/uploadFile\", async files => {\n  const promise = await axios.post(\"https://closer-server.herokuapp.com/task/uploadFile\", files).then(response => {\n    console.log(\"this is response\");\n    console.log(response);\n    console.log(\"this is data\");\n    console.log(response.data); //console.log(response);\n\n    const data = response.data; // assign data\n\n    return data;\n  });\n  const data = await promise;\n  return data;\n});\nexport const assignAfterSave = createAsyncThunk(\"Task/assignAfterSave\", async task => {\n  console.log(task);\n  const promise = await axios.post(`https://closer-server.herokuapp.com/task/assignAfterSave/`, task).then(response => {\n    const data = response.data;\n    return data;\n  });\n  const data = await promise;\n  return data;\n});\nexport const updateTaskStatus = createAsyncThunk(\"Task/updateTaskStatus\", async task => {\n  const {\n    response\n  } = await axios.put(`https://closer-server.herokuapp.com/task/taskStatus/${task._id}`, task);\n  return response;\n});\nexport const updateTask = createAsyncThunk(\"Task/UpdateTask\", async task => {\n  // console.log(task)\n  const promise = await axios.put(`https://closer-server.herokuapp.com/task/${task._id}`, task).then(response => {\n    const data = response.data;\n    console.log(data);\n    return data;\n  });\n  const data = await promise;\n  return data;\n});\nexport const deleteTask = createAsyncThunk(\"Task/deleteTask\", async id => {\n  const promise = await axios.delete(`https://closer-server.herokuapp.com/task/deleteTask/${id}`).then(response => {\n    const data = response.data;\n    return data;\n  });\n  const data = await promise;\n  return data;\n});\nexport const DeleteResources = createAsyncThunk(\"Task/DeleteResources\", async index => {\n  return index;\n});\nexport const UpdateResources = createAsyncThunk(\"Task/UpdateResources\", async resources => {\n  //CoursesSlice.state.Resources.push(resources);\n  console.log(resources);\n  return resources;\n});\nexport const taskSlice = createSlice({\n  name: \"Task\",\n  initialState: {\n    tasks: [],\n    nbrRemis: 0,\n    nbrMissing: 0,\n    files: [],\n    filesL: [],\n    status: null,\n    statusUpload: null\n  },\n  extraReducers: {\n    [getTasks.pending]: (state, action) => {\n      state.status = \"loading\";\n    },\n    [getTasks.fulfilled]: (state, {\n      payload\n    }) => {\n      state.tasks = payload;\n      state.status = \"success\";\n    },\n    [UpdateResources.fulfilled]: (state, action) => {\n      state.files.push(action.payload);\n    },\n    [getTasks.rejected]: (state, action) => {\n      state.status = \"failed\";\n    },\n    [getTaskByTeacher.pending]: (state, action) => {\n      state.status = \"loading\";\n    },\n    [uploadFile.fulfilled]: (state, action) => {\n      state.statusUpload = \"yakhdem\";\n      state.files.push(action.payload);\n    },\n    [addUploadFile.fulfilled]: (state, action) => {\n      console.log(action.payload);\n      state.filesL.push(action.payload);\n    },\n    [DeleteResources.fulfilled]: (state, action) => {\n      let res = action.payload;\n      let resources = state.files.slice();\n      resources = resources.filter(u => {\n        return u[0] !== res;\n      });\n      state.files = resources;\n    },\n    [getTaskByTeacher.fulfilled]: (state, action) => {\n      state.tasks = action.payload;\n      state.status = \"success\";\n    },\n    [getTaskByTeacher.rejected]: (state, action) => {\n      state.status = \"failed\";\n    },\n    [getDetailTask.pending]: (state, action) => {\n      state.status = \"loading\";\n    },\n    [getDetailTask.fulfilled]: (state, {\n      payload\n    }) => {\n      state.tasks = payload;\n      state.status = \"success\";\n    },\n    [getDetailTask.rejected]: (state, action) => {\n      state.status = \"failed\";\n    },\n    postTasks: (state, action) => {\n      state.tasks.push(action.payload);\n    },\n    [deleteTask.pending]: (state, action) => {\n      state.status = \"loading\";\n    },\n    [deleteTask.fulfilled]: (state, action) => {\n      state.tasks = state.tasks.filter(u => {\n        return u._id !== action.payload._id;\n      });\n      state.status = \"success\";\n    },\n    [deleteTask.rejected]: (state, action) => {\n      state.status = \"failed\";\n    },\n    assignTask: (state, action) => {\n      state.tasks.push(action.payload);\n    },\n    [updateTask.pending]: (state, action) => {\n      state.status = \"loading\";\n    },\n    [updateTask.fulfilled]: (state, action) => {\n      const index = state.tasks.findIndex(item => item._id === action.payload._id);\n\n      if (index !== -1) {\n        state.tasks[index] = action.payload;\n        state.status = \"success\";\n      }\n    },\n    [updateTask.rejected]: (state, action) => {\n      state.status = \"failed\";\n    },\n    [updateTaskStatus.pending]: (state, action) => {\n      state.status = \"loading\";\n    },\n    [updateTaskStatus.fulfilled]: (state, {\n      payload\n    }) => {\n      state.tasks = payload;\n    },\n    [updateTaskStatus.rejected]: (state, action) => {\n      state.status = \"failed\";\n    },\n    [getNbrTasksRemis.pending]: (state, action) => {\n      state.status = \"loading\";\n    },\n    [getNbrTasksRemis.fulfilled]: (state, action) => {\n      if (action.payload.length) state.nbrRemis = action.payload[0].count;\n      console.log(state.nbrRemis);\n    },\n    [getNbrTasksRemis.rejected]: (state, action) => {\n      state.status = \"failed\";\n    },\n    [getNbrTasksMissing.pending]: (state, action) => {\n      state.status = \"loading\";\n    },\n    [getNbrTasksMissing.fulfilled]: (state, action) => {\n      if (action.payload.length > 0) state.nbrMissing = action.payload[0].count;\n    },\n    [getNbrTasksMissing.rejected]: (state, action) => {\n      state.status = \"failed\";\n    },\n    [assignAfterSave.pending]: (state, action) => {\n      state.status = \"loading\";\n    },\n    [assignAfterSave.fulfilled]: (state, action) => {\n      const payload = action.payload;\n      const index = state.tasks.findIndex(item => item._id === payload._id);\n\n      if (index !== -1) {\n        state.tasks[index] = payload;\n        state.status = \"success\";\n      }\n    },\n    [assignAfterSave.rejected]: (state, action) => {\n      state.status = \"failed\";\n    }\n  }\n});\nexport default taskSlice.reducer;","map":{"version":3,"sources":["C:/Smart-Virtual-Classroom/client/src/redux/slices/Task.js"],"names":["createAsyncThunk","createSlice","axios","getNbrTasksRemis","id","data","get","getNbrTasksMissing","getTaskByTeacher","taskDetail","console","log","idUser","idClass","getDetailTask","getTasks","assignTask","task","response","post","postTasks","addUploadFile","files","formData","FormData","key","Object","keys","append","uploadFile","promise","then","assignAfterSave","updateTaskStatus","put","_id","updateTask","deleteTask","delete","DeleteResources","index","UpdateResources","resources","taskSlice","name","initialState","tasks","nbrRemis","nbrMissing","filesL","status","statusUpload","extraReducers","pending","state","action","fulfilled","payload","push","rejected","res","slice","filter","u","findIndex","item","length","count","reducer"],"mappings":"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","sourcesContent":["import { createAsyncThunk, createSlice } from \"@reduxjs/toolkit\";\r\nimport axios from \"axios\";\r\n\r\n\r\n\r\nexport const getNbrTasksRemis = createAsyncThunk(\r\n  \"Task/getNbrTasksRemis\",\r\n  async (id) => {\r\n    const { data } = await axios.get(\r\n      `http://localhost:5000/task/StatTaskRemis/${id}`\r\n    );\r\n\r\n    return data;\r\n  }\r\n);\r\nexport const getNbrTasksMissing = createAsyncThunk(\r\n  \"Task/getNbrTasksMissing\",\r\n  async (id) => {\r\n    const { data } = await axios.get(\r\n      `http://localhost:5000/task/StatTaskMissing/${id}`\r\n    );\r\n\r\n    return data;\r\n  }\r\n);\r\nexport const getTaskByTeacher = createAsyncThunk(\r\n  \"Task/getTaskByTeacher\",\r\n  async (taskDetail) => {\r\n    console.log(taskDetail);\r\n    const { data } = await axios.get(\r\n      `https://closer-server.herokuapp.com/task/teacher?idUser=${taskDetail.idUser}&idClass=${taskDetail.idClass}`,\r\n    );\r\n\r\n    return data;\r\n  }\r\n);\r\n\r\nexport const getDetailTask = createAsyncThunk(\r\n  \"Task/getDetailTasks\",\r\n  async (id) => {\r\n    const { data } = await axios.get(\r\n      `https://closer-server.herokuapp.com/task/DetailTask/${id}`\r\n    );\r\n\r\n    return data;\r\n  }\r\n);\r\n\r\nexport const getTasks = createAsyncThunk(\"Task/getTasks\", async () => {\r\n  const { data } = await axios.get(\"https://closer-server.herokuapp.com/task\");\r\n\r\n  return data;\r\n});\r\nexport const assignTask = createAsyncThunk(\"Task/assignTask\", async (task) => {\r\n  const { response } = await axios.post(\r\n    \"https://closer-server.herokuapp.com/task/assign\",\r\n    task\r\n  );\r\n\r\n  return response.data;\r\n});\r\n\r\nexport const postTasks = createAsyncThunk(\"Task/postTask\", async (task) => {\r\n  const { response } = await axios.post(\r\n    \"https://closer-server.herokuapp.com/task\",\r\n    task\r\n  );\r\n\r\n  return response.data;\r\n});\r\n/*upload file add */\r\nexport const addUploadFile = createAsyncThunk(\r\n  \"Task/addUploadFile\",\r\n  async (files) => {\r\n    var formData = new FormData();\r\n    for (const key of Object.keys(files)) {\r\n      formData.append(\"multiple_resources\", files[key]);\r\n    }\r\n\r\n    const response = await axios.post(\r\n      \"https://closer-server.herokuapp.com/task/uploadFile\",\r\n      formData\r\n    );\r\n    console.log(response.data);\r\n\r\n    return response.data;\r\n  }\r\n);\r\n/*upload file */\r\nexport const uploadFile = createAsyncThunk(\"Task/uploadFile\", async (files) => {\r\n  const promise = await axios\r\n    .post(\"https://closer-server.herokuapp.com/task/uploadFile\", files)\r\n    .then((response) => {\r\n      console.log(\"this is response\");\r\n      console.log(response);\r\n      console.log(\"this is data\");\r\n      console.log(response.data);\r\n      //console.log(response);\r\n      const data = response.data;\r\n\r\n      // assign data\r\n      return data;\r\n    });\r\n\r\n  const data = await promise;\r\n\r\n  return data;\r\n});\r\n\r\nexport const assignAfterSave = createAsyncThunk(\r\n  \"Task/assignAfterSave\",\r\n  async (task) => {\r\n    console.log(task);\r\n    const promise = await axios.post(\r\n      `https://closer-server.herokuapp.com/task/assignAfterSave/`,\r\n      task\r\n    ).then((response) => {\r\n      const data = response.data;\r\n      return data;\r\n    });\r\n  \r\n  const data = await promise;\r\n  return data;\r\n  }\r\n);\r\n\r\nexport const updateTaskStatus = createAsyncThunk(\r\n  \"Task/updateTaskStatus\",\r\n  async (task) => {\r\n    const { response } = await axios.put(\r\n      `https://closer-server.herokuapp.com/task/taskStatus/${task._id}`,\r\n      task\r\n    );\r\n\r\n    return response;\r\n  }\r\n);\r\nexport const updateTask = createAsyncThunk(\"Task/UpdateTask\", async (task) => {\r\n  // console.log(task)\r\n  const promise = await axios.put(\r\n    `https://closer-server.herokuapp.com/task/${task._id}`,\r\n    task\r\n  ).then((response) => {\r\n    const data = response.data;\r\n    console.log(data);\r\n    return data;\r\n  });\r\n\r\nconst data = await promise;\r\nreturn data;\r\n\r\n \r\n});\r\nexport const deleteTask = createAsyncThunk(\"Task/deleteTask\", async (id) => {\r\n \r\n  \r\n  const  promise  = await axios.delete(\r\n    `https://closer-server.herokuapp.com/task/deleteTask/${id}`\r\n    \r\n  ).then((response) => {\r\n    const data = response.data;\r\n    return data;\r\n  });\r\n\r\nconst data = await promise;\r\nreturn data;\r\n\r\n\r\n});\r\n\r\nexport const DeleteResources = createAsyncThunk(\r\n  \"Task/DeleteResources\",\r\n\r\n  async (index) => {\r\n    return index;\r\n  }\r\n);\r\n\r\nexport const UpdateResources = createAsyncThunk(\r\n  \"Task/UpdateResources\",\r\n\r\n  async (resources) => {\r\n    //CoursesSlice.state.Resources.push(resources);\r\n    console.log(resources);\r\n    return resources;\r\n  }\r\n);\r\n\r\nexport const taskSlice = createSlice({\r\n  name: \"Task\",\r\n  initialState: {\r\n    tasks: [],\r\n    nbrRemis: 0,\r\n    nbrMissing: 0,\r\n    files: [],\r\n    filesL: [],\r\n\r\n    status: null,\r\n    statusUpload: null,\r\n  },\r\n  extraReducers: {\r\n    [getTasks.pending]: (state, action) => {\r\n      state.status = \"loading\";\r\n    },\r\n    [getTasks.fulfilled]: (state, { payload }) => {\r\n      state.tasks = payload;\r\n      state.status = \"success\";\r\n    },\r\n    [UpdateResources.fulfilled]: (state, action) => {\r\n      state.files.push(action.payload);\r\n    },\r\n    [getTasks.rejected]: (state, action) => {\r\n      state.status = \"failed\";\r\n    },\r\n    [getTaskByTeacher.pending]: (state, action) => {\r\n      state.status = \"loading\";\r\n    },\r\n    [uploadFile.fulfilled]: (state, action) => {\r\n      state.statusUpload = \"yakhdem\";\r\n      state.files.push(action.payload);\r\n    },\r\n    [addUploadFile.fulfilled]: (state, action) => {\r\n      console.log(action.payload);\r\n      state.filesL.push(action.payload);\r\n    },\r\n    [DeleteResources.fulfilled]: (state, action) => {\r\n      let res = action.payload;\r\n      let resources = state.files.slice();\r\n      resources = resources.filter((u) => {\r\n        return u[0] !== res;\r\n      });\r\n      state.files = resources;\r\n    },\r\n    [getTaskByTeacher.fulfilled]: (state, action) => {\r\n      state.tasks = action.payload;\r\n      state.status = \"success\";\r\n    },\r\n    [getTaskByTeacher.rejected]: (state, action) => {\r\n      state.status = \"failed\";\r\n    },\r\n    [getDetailTask.pending]: (state, action) => {\r\n      state.status = \"loading\";\r\n    },\r\n    [getDetailTask.fulfilled]: (state, { payload }) => {\r\n      state.tasks = payload;\r\n      state.status = \"success\";\r\n    },\r\n    [getDetailTask.rejected]: (state, action) => {\r\n      state.status = \"failed\";\r\n    },\r\n\r\n    postTasks: (state, action) => {\r\n      state.tasks.push(action.payload);\r\n    },\r\n    [deleteTask.pending]: (state, action) => {\r\n      state.status = \"loading\";\r\n    },\r\n    [deleteTask.fulfilled]: (state, action ) => {\r\n      state.tasks = state.tasks.filter((u) => {\r\n        return u._id !== action.payload._id;\r\n      });\r\n      \r\n      state.status = \"success\";\r\n     \r\n    },\r\n    [deleteTask.rejected]: (state, action) => {\r\n      state.status = \"failed\";\r\n    },\r\n   \r\n    assignTask: (state, action) => {\r\n      state.tasks.push(action.payload);\r\n    },\r\n    [updateTask.pending]: (state, action) => {\r\n      state.status = \"loading\";\r\n    },\r\n    [updateTask.fulfilled]: (state, action ) => {\r\n     const index = state.tasks.findIndex(\r\n        (item) => item._id === action.payload._id\r\n      );\r\n      if (index !== -1) {\r\n        state.tasks[index] = action.payload;\r\n        state.status = \"success\";\r\n      }\r\n\r\n    },\r\n    [updateTask.rejected]: (state, action) => {\r\n      state.status = \"failed\";\r\n    },\r\n    [updateTaskStatus.pending]: (state, action) => {\r\n      state.status = \"loading\";\r\n    },\r\n    [updateTaskStatus.fulfilled]: (state, { payload }) => {\r\n      state.tasks = payload;\r\n    },\r\n    [updateTaskStatus.rejected]: (state, action) => {\r\n      state.status = \"failed\";\r\n    },\r\n    [getNbrTasksRemis.pending]: (state, action) => {\r\n      state.status = \"loading\";\r\n    },\r\n    [getNbrTasksRemis.fulfilled]: (state, action) => {\r\n      \r\n      if(action.payload.length)\r\n        state.nbrRemis = action.payload[0].count;\r\n      \r\n      console.log(state.nbrRemis);\r\n    },\r\n    [getNbrTasksRemis.rejected]: (state, action) => {\r\n      state.status = \"failed\";\r\n    },\r\n    [getNbrTasksMissing.pending]: (state, action) => {\r\n      state.status = \"loading\";\r\n    },\r\n    [getNbrTasksMissing.fulfilled]: (state, action) => {\r\n      if (action.payload.length > 0) \r\n      state.nbrMissing = action.payload[0].count;\r\n    },\r\n    [getNbrTasksMissing.rejected]: (state, action) => {\r\n      state.status = \"failed\";\r\n    },\r\n    [assignAfterSave.pending]: (state, action) => {\r\n      state.status = \"loading\";\r\n    },\r\n    [assignAfterSave.fulfilled]: (state, action) => {\r\n      const payload = action.payload;\r\n      const index = state.tasks.findIndex(\r\n        (item) => item._id === payload._id\r\n      );\r\n      if (index !== -1) {\r\n        state.tasks[index] = payload;\r\n        state.status = \"success\";\r\n      }\r\n    },\r\n    [assignAfterSave.rejected]: (state, action) => {\r\n      state.status = \"failed\";\r\n    },\r\n  },\r\n});\r\n\r\nexport default taskSlice.reducer;\r\n"]},"metadata":{},"sourceType":"module"}