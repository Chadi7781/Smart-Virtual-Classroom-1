{"ast":null,"code":"import { createAsyncThunk, createSlice } from \"@reduxjs/toolkit\";\nimport axios from \"axios\";\nconst url = `http://localhost:5000/`;\nexport const getNbrTasksRemis = createAsyncThunk(\"Task/getNbrTasksRemis\", async id => {\n  const {\n    data\n  } = await axios.get(`http://localhost:5000/task/StatTaskRemis/${id}`);\n  return data;\n});\nexport const getNbrTasksMissing = createAsyncThunk(\"Task/getNbrTasksMissing\", async id => {\n  const {\n    data\n  } = await axios.get(`http://localhost:5000/task/StatTaskMissing/${id}`);\n  return data;\n});\nexport const getTaskByTeacher = createAsyncThunk(\"Task/getTaskByTeacher\", id, async () => {\n  const {\n    data\n  } = await axios.get(`http://localhost:5000/task/${id}`);\n  return data;\n});\nexport const getDetailTask = createAsyncThunk(\"Task/getDetailTasks\", async id => {\n  const {\n    data\n  } = await axios.get(`http://localhost:5000/task/DetailTask/${id}`);\n  return data;\n});\nexport const getTasks = createAsyncThunk(\"Task/getTasks\", async () => {\n  const {\n    data\n  } = await axios.get(\"http://localhost:5000/task\");\n  return data;\n});\nexport const assignTask = createAsyncThunk(\"Task/assignTask\", async task => {\n  const {\n    response\n  } = await axios.post(\"http://localhost:5000/task/assign\", task);\n  return response.data;\n});\nexport const postTasks = createAsyncThunk(\"Task/postTask\", async task => {\n  const {\n    response\n  } = await axios.post(\"http://localhost:5000/task\", task);\n  return response.data;\n});\n/*upload file add */\n\nexport const addUploadFile = createAsyncThunk(\"Task/addUploadFile\", async files => {\n  var formData = new FormData();\n\n  for (const key of Object.keys(files)) {\n    formData.append(\"listQuestion\", files[key]);\n  }\n\n  const response = await axios.post(\"https://closer-server.herokuapp.com/task/uploadFile\", formData);\n  console.log(response.data);\n  return response.data;\n});\n/*upload file */\n\nexport const uploadFile = createAsyncThunk(\"Task/uploadFile\", async files => {\n  const promise = await axios.post(\"https://closer-server.herokuapp.com/task/uploadFile\", files).then(response => {\n    console.log(\"this is response\");\n    console.log(response);\n    console.log(\"this is data\");\n    console.log(response.data); //console.log(response);\n\n    const data = response.data; // assign data\n\n    return data;\n  });\n  const data = await promise;\n  return data;\n});\nexport const assignAfterSave = createAsyncThunk(\"Task/assignAfterSave\", async task => {\n  const {\n    response\n  } = await axios.post(`http://localhost:5000/task/assignAfterSave/`, task);\n  return response;\n});\nexport const updateTaskStatus = createAsyncThunk(\"Task/updateTaskStatus\", async task => {\n  const {\n    response\n  } = await axios.put(`http://localhost:5000/task/taskStatus/${task._id}`, task);\n  return response;\n});\nexport const updateTask = createAsyncThunk(\"Task/UpdateTask\", async task => {\n  // console.log(task)\n  const {\n    response\n  } = await axios.put(`http://localhost:5000/task/${task._id}`, task);\n  return response;\n});\nexport const DeleteResources = createAsyncThunk(\"Task/DeleteResources\", async index => {\n  return index;\n});\nexport const UpdateResources = createAsyncThunk(\"Task/UpdateResources\", async resources => {\n  //CoursesSlice.state.Resources.push(resources);\n  console.log(resources);\n  return resources;\n});\nexport const taskSlice = createSlice({\n  name: \"Task\",\n  initialState: {\n    tasks: [],\n    nbrRemis: 0,\n    nbrMissing: 0,\n    files: [],\n    filesL: [],\n    status: null,\n    statusUpload: null\n  },\n  extraReducers: {\n    [getTasks.pending]: (state, action) => {\n      state.status = \"loading\";\n    },\n    [getTasks.fulfilled]: (state, {\n      payload\n    }) => {\n      state.tasks = payload;\n      state.status = \"success\";\n    },\n    [UpdateResources.fulfilled]: (state, action) => {\n      state.files.push(action.payload);\n    },\n    [getTasks.rejected]: (state, action) => {\n      state.status = \"failed\";\n    },\n    [getTaskByTeacher.pending]: (state, action) => {\n      state.status = \"loading\";\n    },\n    [uploadFile.fulfilled]: (state, action) => {\n      state.statusUpload = \"yakhdem\";\n      state.files.push(action.payload);\n    },\n    [addUploadFile.fulfilled]: (state, action) => {\n      state.filesL.push(action.payload);\n    },\n    [DeleteResources.fulfilled]: (state, action) => {\n      let res = action.payload;\n      let resources = state.files.slice();\n      resources = resources.filter(u => {\n        return u[0] !== res;\n      });\n      state.files = resources;\n    },\n    [getTaskByTeacher.fulfilled]: (state, {\n      payload\n    }) => {\n      state.tasks = payload;\n      state.status = \"success\";\n    },\n    [getTaskByTeacher.rejected]: (state, action) => {\n      state.status = \"failed\";\n    },\n    [getDetailTask.pending]: (state, action) => {\n      state.status = \"loading\";\n    },\n    [getDetailTask.fulfilled]: (state, {\n      payload\n    }) => {\n      state.tasks = payload;\n      state.status = \"success\";\n    },\n    [getDetailTask.rejected]: (state, action) => {\n      state.status = \"failed\";\n    },\n    postTasks: (state, action) => {\n      state.tasks.push(action.payload);\n    },\n    assignTask: (state, action) => {\n      state.tasks.push(action.payload);\n    },\n    [updateTask.pending]: (state, action) => {\n      state.status = \"loading\";\n    },\n    [updateTask.fulfilled]: (state, {\n      payload\n    }) => {\n      state.tasks = payload;\n    },\n    [updateTask.rejected]: (state, action) => {\n      state.status = \"failed\";\n    },\n    [updateTaskStatus.pending]: (state, action) => {\n      state.status = \"loading\";\n    },\n    [updateTaskStatus.fulfilled]: (state, {\n      payload\n    }) => {\n      state.tasks = payload;\n    },\n    [updateTaskStatus.rejected]: (state, action) => {\n      state.status = \"failed\";\n    },\n    [getNbrTasksRemis.pending]: (state, action) => {\n      state.status = \"loading\";\n    },\n    [getNbrTasksRemis.fulfilled]: (state, action) => {\n      if (action.payload.length > 0) state.nbrRemis = action.payload[0].count;\n    },\n    [getNbrTasksRemis.rejected]: (state, action) => {\n      state.status = \"failed\";\n    },\n    [getNbrTasksMissing.pending]: (state, action) => {\n      state.status = \"loading\";\n    },\n    [getNbrTasksMissing.fulfilled]: (state, action) => {\n      if (action.payload.length > 0) state.nbrMissing = action.payload[0].count;\n    },\n    [getNbrTasksMissing.rejected]: (state, action) => {\n      state.status = \"failed\";\n    },\n    [assignAfterSave.pending]: (state, action) => {\n      state.status = \"loading\";\n    },\n    [assignAfterSave.fulfilled]: (state, action) => {\n      state.tasks.push(action.payload);\n    },\n    [assignAfterSave.rejected]: (state, action) => {\n      state.status = \"failed\";\n    }\n  }\n});\nexport default taskSlice.reducer;","map":{"version":3,"sources":["C:/Smart-Virtual-Classroom/client/src/redux/slices/Task.js"],"names":["createAsyncThunk","createSlice","axios","url","getNbrTasksRemis","id","data","get","getNbrTasksMissing","getTaskByTeacher","getDetailTask","getTasks","assignTask","task","response","post","postTasks","addUploadFile","files","formData","FormData","key","Object","keys","append","console","log","uploadFile","promise","then","assignAfterSave","updateTaskStatus","put","_id","updateTask","DeleteResources","index","UpdateResources","resources","taskSlice","name","initialState","tasks","nbrRemis","nbrMissing","filesL","status","statusUpload","extraReducers","pending","state","action","fulfilled","payload","push","rejected","res","slice","filter","u","length","count","reducer"],"mappings":"AAAA,SAASA,gBAAT,EAA2BC,WAA3B,QAA8C,kBAA9C;AACA,OAAOC,KAAP,MAAkB,OAAlB;AAEA,MAAMC,GAAG,GAAG,wBAAZ;AAEA,OAAO,MAAMC,gBAAgB,GAAGJ,gBAAgB,CAC9C,uBAD8C,EAE9C,MAAOK,EAAP,IAAc;AACZ,QAAM;AAAEC,IAAAA;AAAF,MAAW,MAAMJ,KAAK,CAACK,GAAN,CACpB,4CAA2CF,EAAG,EAD1B,CAAvB;AAIA,SAAOC,IAAP;AACD,CAR6C,CAAzC;AAUP,OAAO,MAAME,kBAAkB,GAAGR,gBAAgB,CAChD,yBADgD,EAEhD,MAAOK,EAAP,IAAc;AACZ,QAAM;AAAEC,IAAAA;AAAF,MAAW,MAAMJ,KAAK,CAACK,GAAN,CACpB,8CAA6CF,EAAG,EAD5B,CAAvB;AAIA,SAAOC,IAAP;AACD,CAR+C,CAA3C;AAUP,OAAO,MAAMG,gBAAgB,GAAGT,gBAAgB,CAC9C,uBAD8C,EACtBK,EADsB,EAE9C,YAAY;AACV,QAAM;AAAEC,IAAAA;AAAF,MAAW,MAAMJ,KAAK,CAACK,GAAN,CACpB,8BAA6BF,EAAG,EADZ,CAAvB;AAIA,SAAOC,IAAP;AACD,CAR6C,CAAzC;AAWP,OAAO,MAAMI,aAAa,GAAGV,gBAAgB,CAC3C,qBAD2C,EAE3C,MAAOK,EAAP,IAAc;AACZ,QAAM;AAAEC,IAAAA;AAAF,MAAW,MAAMJ,KAAK,CAACK,GAAN,CACpB,yCAAwCF,EAAG,EADvB,CAAvB;AAIA,SAAOC,IAAP;AACD,CAR0C,CAAtC;AAWP,OAAO,MAAMK,QAAQ,GAAGX,gBAAgB,CAAC,eAAD,EAAkB,YAAY;AACpE,QAAM;AAAEM,IAAAA;AAAF,MAAW,MAAMJ,KAAK,CAACK,GAAN,CAAU,4BAAV,CAAvB;AAEA,SAAOD,IAAP;AACD,CAJuC,CAAjC;AAKP,OAAO,MAAMM,UAAU,GAAGZ,gBAAgB,CAAC,iBAAD,EAAoB,MAAOa,IAAP,IAAgB;AAC5E,QAAM;AAAEC,IAAAA;AAAF,MAAe,MAAMZ,KAAK,CAACa,IAAN,CACzB,mCADyB,EAEzBF,IAFyB,CAA3B;AAKA,SAAOC,QAAQ,CAACR,IAAhB;AACD,CAPyC,CAAnC;AASP,OAAO,MAAMU,SAAS,GAAGhB,gBAAgB,CAAC,eAAD,EAAkB,MAAOa,IAAP,IAAgB;AACzE,QAAM;AAAEC,IAAAA;AAAF,MAAe,MAAMZ,KAAK,CAACa,IAAN,CACzB,4BADyB,EAEzBF,IAFyB,CAA3B;AAKA,SAAOC,QAAQ,CAACR,IAAhB;AACD,CAPwC,CAAlC;AAQP;;AACA,OAAO,MAAMW,aAAa,GAAGjB,gBAAgB,CAC3C,oBAD2C,EAE3C,MAAOkB,KAAP,IAAiB;AACf,MAAIC,QAAQ,GAAG,IAAIC,QAAJ,EAAf;;AACA,OAAK,MAAMC,GAAX,IAAkBC,MAAM,CAACC,IAAP,CAAYL,KAAZ,CAAlB,EAAsC;AACpCC,IAAAA,QAAQ,CAACK,MAAT,CAAgB,cAAhB,EAAgCN,KAAK,CAACG,GAAD,CAArC;AACD;;AAED,QAAMP,QAAQ,GAAG,MAAMZ,KAAK,CAACa,IAAN,CACrB,qDADqB,EAErBI,QAFqB,CAAvB;AAIAM,EAAAA,OAAO,CAACC,GAAR,CAAYZ,QAAQ,CAACR,IAArB;AAEA,SAAOQ,QAAQ,CAACR,IAAhB;AACD,CAf0C,CAAtC;AAiBP;;AACA,OAAO,MAAMqB,UAAU,GAAG3B,gBAAgB,CAAC,iBAAD,EAAoB,MAAOkB,KAAP,IAAiB;AAC7E,QAAMU,OAAO,GAAG,MAAM1B,KAAK,CACxBa,IADmB,CACd,qDADc,EACyCG,KADzC,EAEnBW,IAFmB,CAEbf,QAAD,IAAc;AAClBW,IAAAA,OAAO,CAACC,GAAR,CAAY,kBAAZ;AACAD,IAAAA,OAAO,CAACC,GAAR,CAAYZ,QAAZ;AACAW,IAAAA,OAAO,CAACC,GAAR,CAAY,cAAZ;AACAD,IAAAA,OAAO,CAACC,GAAR,CAAYZ,QAAQ,CAACR,IAArB,EAJkB,CAKlB;;AACA,UAAMA,IAAI,GAAGQ,QAAQ,CAACR,IAAtB,CANkB,CAQlB;;AACA,WAAOA,IAAP;AACD,GAZmB,CAAtB;AAcA,QAAMA,IAAI,GAAG,MAAMsB,OAAnB;AAEA,SAAOtB,IAAP;AACD,CAlByC,CAAnC;AAoBP,OAAO,MAAMwB,eAAe,GAAG9B,gBAAgB,CAC7C,sBAD6C,EAE7C,MAAOa,IAAP,IAAgB;AACd,QAAM;AAAEC,IAAAA;AAAF,MAAe,MAAMZ,KAAK,CAACa,IAAN,CACxB,6CADwB,EAEzBF,IAFyB,CAA3B;AAKA,SAAOC,QAAP;AACD,CAT4C,CAAxC;AAYP,OAAO,MAAMiB,gBAAgB,GAAG/B,gBAAgB,CAC9C,uBAD8C,EAE9C,MAAOa,IAAP,IAAgB;AACd,QAAM;AAAEC,IAAAA;AAAF,MAAe,MAAMZ,KAAK,CAAC8B,GAAN,CACxB,yCAAwCnB,IAAI,CAACoB,GAAI,EADzB,EAEzBpB,IAFyB,CAA3B;AAKA,SAAOC,QAAP;AACD,CAT6C,CAAzC;AAWP,OAAO,MAAMoB,UAAU,GAAGlC,gBAAgB,CAAC,iBAAD,EAAoB,MAAOa,IAAP,IAAgB;AAC5E;AACA,QAAM;AAAEC,IAAAA;AAAF,MAAe,MAAMZ,KAAK,CAAC8B,GAAN,CACxB,8BAA6BnB,IAAI,CAACoB,GAAI,EADd,EAEzBpB,IAFyB,CAA3B;AAKA,SAAOC,QAAP;AACD,CARyC,CAAnC;AAUP,OAAO,MAAMqB,eAAe,GAAGnC,gBAAgB,CAC7C,sBAD6C,EAG7C,MAAOoC,KAAP,IAAiB;AACf,SAAOA,KAAP;AACD,CAL4C,CAAxC;AAQP,OAAO,MAAMC,eAAe,GAAGrC,gBAAgB,CAC7C,sBAD6C,EAG7C,MAAOsC,SAAP,IAAqB;AACnB;AACAb,EAAAA,OAAO,CAACC,GAAR,CAAYY,SAAZ;AACA,SAAOA,SAAP;AACD,CAP4C,CAAxC;AAUP,OAAO,MAAMC,SAAS,GAAGtC,WAAW,CAAC;AACnCuC,EAAAA,IAAI,EAAE,MAD6B;AAEnCC,EAAAA,YAAY,EAAE;AACZC,IAAAA,KAAK,EAAE,EADK;AAEZC,IAAAA,QAAQ,EAAE,CAFE;AAGZC,IAAAA,UAAU,EAAE,CAHA;AAIZ1B,IAAAA,KAAK,EAAE,EAJK;AAKZ2B,IAAAA,MAAM,EAAE,EALI;AAOZC,IAAAA,MAAM,EAAE,IAPI;AAQZC,IAAAA,YAAY,EAAE;AARF,GAFqB;AAYnCC,EAAAA,aAAa,EAAE;AACb,KAACrC,QAAQ,CAACsC,OAAV,GAAoB,CAACC,KAAD,EAAQC,MAAR,KAAmB;AACrCD,MAAAA,KAAK,CAACJ,MAAN,GAAe,SAAf;AACD,KAHY;AAIb,KAACnC,QAAQ,CAACyC,SAAV,GAAsB,CAACF,KAAD,EAAQ;AAAEG,MAAAA;AAAF,KAAR,KAAwB;AAC5CH,MAAAA,KAAK,CAACR,KAAN,GAAcW,OAAd;AACAH,MAAAA,KAAK,CAACJ,MAAN,GAAe,SAAf;AACD,KAPY;AAQb,KAACT,eAAe,CAACe,SAAjB,GAA6B,CAACF,KAAD,EAAQC,MAAR,KAAmB;AAC9CD,MAAAA,KAAK,CAAChC,KAAN,CAAYoC,IAAZ,CAAiBH,MAAM,CAACE,OAAxB;AACD,KAVY;AAWb,KAAC1C,QAAQ,CAAC4C,QAAV,GAAqB,CAACL,KAAD,EAAQC,MAAR,KAAmB;AACtCD,MAAAA,KAAK,CAACJ,MAAN,GAAe,QAAf;AACD,KAbY;AAcb,KAACrC,gBAAgB,CAACwC,OAAlB,GAA4B,CAACC,KAAD,EAAQC,MAAR,KAAmB;AAC7CD,MAAAA,KAAK,CAACJ,MAAN,GAAe,SAAf;AACD,KAhBY;AAiBb,KAACnB,UAAU,CAACyB,SAAZ,GAAwB,CAACF,KAAD,EAAQC,MAAR,KAAmB;AACzCD,MAAAA,KAAK,CAACH,YAAN,GAAqB,SAArB;AACAG,MAAAA,KAAK,CAAChC,KAAN,CAAYoC,IAAZ,CAAiBH,MAAM,CAACE,OAAxB;AACD,KApBY;AAqBb,KAACpC,aAAa,CAACmC,SAAf,GAA2B,CAACF,KAAD,EAAQC,MAAR,KAAmB;AAC5CD,MAAAA,KAAK,CAACL,MAAN,CAAaS,IAAb,CAAkBH,MAAM,CAACE,OAAzB;AACD,KAvBY;AAwBb,KAAClB,eAAe,CAACiB,SAAjB,GAA6B,CAACF,KAAD,EAAQC,MAAR,KAAmB;AAC9C,UAAIK,GAAG,GAAGL,MAAM,CAACE,OAAjB;AACA,UAAIf,SAAS,GAAGY,KAAK,CAAChC,KAAN,CAAYuC,KAAZ,EAAhB;AACAnB,MAAAA,SAAS,GAAGA,SAAS,CAACoB,MAAV,CAAkBC,CAAD,IAAO;AAClC,eAAOA,CAAC,CAAC,CAAD,CAAD,KAASH,GAAhB;AACD,OAFW,CAAZ;AAGAN,MAAAA,KAAK,CAAChC,KAAN,GAAcoB,SAAd;AACD,KA/BY;AAgCb,KAAC7B,gBAAgB,CAAC2C,SAAlB,GAA8B,CAACF,KAAD,EAAQ;AAAEG,MAAAA;AAAF,KAAR,KAAwB;AACpDH,MAAAA,KAAK,CAACR,KAAN,GAAcW,OAAd;AACAH,MAAAA,KAAK,CAACJ,MAAN,GAAe,SAAf;AACD,KAnCY;AAoCb,KAACrC,gBAAgB,CAAC8C,QAAlB,GAA6B,CAACL,KAAD,EAAQC,MAAR,KAAmB;AAC9CD,MAAAA,KAAK,CAACJ,MAAN,GAAe,QAAf;AACD,KAtCY;AAuCb,KAACpC,aAAa,CAACuC,OAAf,GAAyB,CAACC,KAAD,EAAQC,MAAR,KAAmB;AAC1CD,MAAAA,KAAK,CAACJ,MAAN,GAAe,SAAf;AACD,KAzCY;AA0Cb,KAACpC,aAAa,CAAC0C,SAAf,GAA2B,CAACF,KAAD,EAAQ;AAAEG,MAAAA;AAAF,KAAR,KAAwB;AACjDH,MAAAA,KAAK,CAACR,KAAN,GAAcW,OAAd;AACAH,MAAAA,KAAK,CAACJ,MAAN,GAAe,SAAf;AACD,KA7CY;AA8Cb,KAACpC,aAAa,CAAC6C,QAAf,GAA0B,CAACL,KAAD,EAAQC,MAAR,KAAmB;AAC3CD,MAAAA,KAAK,CAACJ,MAAN,GAAe,QAAf;AACD,KAhDY;AAkDb9B,IAAAA,SAAS,EAAE,CAACkC,KAAD,EAAQC,MAAR,KAAmB;AAC5BD,MAAAA,KAAK,CAACR,KAAN,CAAYY,IAAZ,CAAiBH,MAAM,CAACE,OAAxB;AACD,KApDY;AAqDbzC,IAAAA,UAAU,EAAE,CAACsC,KAAD,EAAQC,MAAR,KAAmB;AAC7BD,MAAAA,KAAK,CAACR,KAAN,CAAYY,IAAZ,CAAiBH,MAAM,CAACE,OAAxB;AACD,KAvDY;AAwDb,KAACnB,UAAU,CAACe,OAAZ,GAAsB,CAACC,KAAD,EAAQC,MAAR,KAAmB;AACvCD,MAAAA,KAAK,CAACJ,MAAN,GAAe,SAAf;AACD,KA1DY;AA2Db,KAACZ,UAAU,CAACkB,SAAZ,GAAwB,CAACF,KAAD,EAAQ;AAAEG,MAAAA;AAAF,KAAR,KAAwB;AAC9CH,MAAAA,KAAK,CAACR,KAAN,GAAcW,OAAd;AACD,KA7DY;AA8Db,KAACnB,UAAU,CAACqB,QAAZ,GAAuB,CAACL,KAAD,EAAQC,MAAR,KAAmB;AACxCD,MAAAA,KAAK,CAACJ,MAAN,GAAe,QAAf;AACD,KAhEY;AAiEb,KAACf,gBAAgB,CAACkB,OAAlB,GAA4B,CAACC,KAAD,EAAQC,MAAR,KAAmB;AAC7CD,MAAAA,KAAK,CAACJ,MAAN,GAAe,SAAf;AACD,KAnEY;AAoEb,KAACf,gBAAgB,CAACqB,SAAlB,GAA8B,CAACF,KAAD,EAAQ;AAAEG,MAAAA;AAAF,KAAR,KAAwB;AACpDH,MAAAA,KAAK,CAACR,KAAN,GAAcW,OAAd;AACD,KAtEY;AAuEb,KAACtB,gBAAgB,CAACwB,QAAlB,GAA6B,CAACL,KAAD,EAAQC,MAAR,KAAmB;AAC9CD,MAAAA,KAAK,CAACJ,MAAN,GAAe,QAAf;AACD,KAzEY;AA0Eb,KAAC1C,gBAAgB,CAAC6C,OAAlB,GAA4B,CAACC,KAAD,EAAQC,MAAR,KAAmB;AAC7CD,MAAAA,KAAK,CAACJ,MAAN,GAAe,SAAf;AACD,KA5EY;AA6Eb,KAAC1C,gBAAgB,CAACgD,SAAlB,GAA8B,CAACF,KAAD,EAAQC,MAAR,KAAmB;AAC/C,UAAIA,MAAM,CAACE,OAAP,CAAeO,MAAf,GAAwB,CAA5B,EAA+BV,KAAK,CAACP,QAAN,GAAiBQ,MAAM,CAACE,OAAP,CAAe,CAAf,EAAkBQ,KAAnC;AAChC,KA/EY;AAgFb,KAACzD,gBAAgB,CAACmD,QAAlB,GAA6B,CAACL,KAAD,EAAQC,MAAR,KAAmB;AAC9CD,MAAAA,KAAK,CAACJ,MAAN,GAAe,QAAf;AACD,KAlFY;AAmFb,KAACtC,kBAAkB,CAACyC,OAApB,GAA8B,CAACC,KAAD,EAAQC,MAAR,KAAmB;AAC/CD,MAAAA,KAAK,CAACJ,MAAN,GAAe,SAAf;AACD,KArFY;AAsFb,KAACtC,kBAAkB,CAAC4C,SAApB,GAAgC,CAACF,KAAD,EAAQC,MAAR,KAAmB;AACjD,UAAIA,MAAM,CAACE,OAAP,CAAeO,MAAf,GAAwB,CAA5B,EAA+BV,KAAK,CAACN,UAAN,GAAmBO,MAAM,CAACE,OAAP,CAAe,CAAf,EAAkBQ,KAArC;AAChC,KAxFY;AAyFb,KAACrD,kBAAkB,CAAC+C,QAApB,GAA+B,CAACL,KAAD,EAAQC,MAAR,KAAmB;AAChDD,MAAAA,KAAK,CAACJ,MAAN,GAAe,QAAf;AACD,KA3FY;AA4Fb,KAAChB,eAAe,CAACmB,OAAjB,GAA2B,CAACC,KAAD,EAAQC,MAAR,KAAmB;AAC5CD,MAAAA,KAAK,CAACJ,MAAN,GAAe,SAAf;AACD,KA9FY;AA+Fb,KAAChB,eAAe,CAACsB,SAAjB,GAA6B,CAACF,KAAD,EAAQC,MAAR,KAAmB;AAC9CD,MAAAA,KAAK,CAACR,KAAN,CAAYY,IAAZ,CAAiBH,MAAM,CAACE,OAAxB;AACD,KAjGY;AAkGb,KAACvB,eAAe,CAACyB,QAAjB,GAA4B,CAACL,KAAD,EAAQC,MAAR,KAAmB;AAC7CD,MAAAA,KAAK,CAACJ,MAAN,GAAe,QAAf;AACD;AApGY;AAZoB,CAAD,CAA7B;AAoHP,eAAeP,SAAS,CAACuB,OAAzB","sourcesContent":["import { createAsyncThunk, createSlice } from \"@reduxjs/toolkit\";\r\nimport axios from \"axios\";\r\n\r\nconst url =`http://localhost:5000/`\r\n\r\nexport const getNbrTasksRemis = createAsyncThunk(\r\n  \"Task/getNbrTasksRemis\",\r\n  async (id) => {\r\n    const { data } = await axios.get(\r\n      `http://localhost:5000/task/StatTaskRemis/${id}`\r\n    );\r\n\r\n    return data;\r\n  }\r\n);\r\nexport const getNbrTasksMissing = createAsyncThunk(\r\n  \"Task/getNbrTasksMissing\",\r\n  async (id) => {\r\n    const { data } = await axios.get(\r\n      `http://localhost:5000/task/StatTaskMissing/${id}`\r\n    );\r\n\r\n    return data;\r\n  }\r\n);\r\nexport const getTaskByTeacher = createAsyncThunk(\r\n  \"Task/getTaskByTeacher\",id,\r\n  async () => {\r\n    const { data } = await axios.get(\r\n      `http://localhost:5000/task/${id}`\r\n    );\r\n\r\n    return data;\r\n  }\r\n);\r\n\r\nexport const getDetailTask = createAsyncThunk(\r\n  \"Task/getDetailTasks\",\r\n  async (id) => {\r\n    const { data } = await axios.get(\r\n      `http://localhost:5000/task/DetailTask/${id}`\r\n    );\r\n\r\n    return data;\r\n  }\r\n);\r\n\r\nexport const getTasks = createAsyncThunk(\"Task/getTasks\", async () => {\r\n  const { data } = await axios.get(\"http://localhost:5000/task\");\r\n\r\n  return data;\r\n});\r\nexport const assignTask = createAsyncThunk(\"Task/assignTask\", async (task) => {\r\n  const { response } = await axios.post(\r\n    \"http://localhost:5000/task/assign\",\r\n    task\r\n  );\r\n\r\n  return response.data;\r\n});\r\n\r\nexport const postTasks = createAsyncThunk(\"Task/postTask\", async (task) => {\r\n  const { response } = await axios.post(\r\n    \"http://localhost:5000/task\",\r\n    task\r\n  );\r\n\r\n  return response.data;\r\n});\r\n/*upload file add */\r\nexport const addUploadFile = createAsyncThunk(\r\n  \"Task/addUploadFile\",\r\n  async (files) => {\r\n    var formData = new FormData();\r\n    for (const key of Object.keys(files)) {\r\n      formData.append(\"listQuestion\", files[key]);\r\n    }\r\n\r\n    const response = await axios.post(\r\n      \"https://closer-server.herokuapp.com/task/uploadFile\",\r\n      formData\r\n    );\r\n    console.log(response.data);\r\n\r\n    return response.data;\r\n  }\r\n);\r\n/*upload file */\r\nexport const uploadFile = createAsyncThunk(\"Task/uploadFile\", async (files) => {\r\n  const promise = await axios\r\n    .post(\"https://closer-server.herokuapp.com/task/uploadFile\", files)\r\n    .then((response) => {\r\n      console.log(\"this is response\");\r\n      console.log(response);\r\n      console.log(\"this is data\");\r\n      console.log(response.data);\r\n      //console.log(response);\r\n      const data = response.data;\r\n\r\n      // assign data\r\n      return data;\r\n    });\r\n\r\n  const data = await promise;\r\n\r\n  return data;\r\n});\r\n\r\nexport const assignAfterSave = createAsyncThunk(\r\n  \"Task/assignAfterSave\",\r\n  async (task) => {\r\n    const { response } = await axios.post(\r\n      `http://localhost:5000/task/assignAfterSave/`,\r\n      task\r\n    );\r\n\r\n    return response;\r\n  }\r\n);\r\n\r\nexport const updateTaskStatus = createAsyncThunk(\r\n  \"Task/updateTaskStatus\",\r\n  async (task) => {\r\n    const { response } = await axios.put(\r\n      `http://localhost:5000/task/taskStatus/${task._id}`,\r\n      task\r\n    );\r\n\r\n    return response;\r\n  }\r\n);\r\nexport const updateTask = createAsyncThunk(\"Task/UpdateTask\", async (task) => {\r\n  // console.log(task)\r\n  const { response } = await axios.put(\r\n    `http://localhost:5000/task/${task._id}`,\r\n    task\r\n  );\r\n\r\n  return response;\r\n});\r\n\r\nexport const DeleteResources = createAsyncThunk(\r\n  \"Task/DeleteResources\",\r\n\r\n  async (index) => {\r\n    return index;\r\n  }\r\n);\r\n\r\nexport const UpdateResources = createAsyncThunk(\r\n  \"Task/UpdateResources\",\r\n\r\n  async (resources) => {\r\n    //CoursesSlice.state.Resources.push(resources);\r\n    console.log(resources);\r\n    return resources;\r\n  }\r\n);\r\n\r\nexport const taskSlice = createSlice({\r\n  name: \"Task\",\r\n  initialState: {\r\n    tasks: [],\r\n    nbrRemis: 0,\r\n    nbrMissing: 0,\r\n    files: [],\r\n    filesL: [],\r\n\r\n    status: null,\r\n    statusUpload: null,\r\n  },\r\n  extraReducers: {\r\n    [getTasks.pending]: (state, action) => {\r\n      state.status = \"loading\";\r\n    },\r\n    [getTasks.fulfilled]: (state, { payload }) => {\r\n      state.tasks = payload;\r\n      state.status = \"success\";\r\n    },\r\n    [UpdateResources.fulfilled]: (state, action) => {\r\n      state.files.push(action.payload);\r\n    },\r\n    [getTasks.rejected]: (state, action) => {\r\n      state.status = \"failed\";\r\n    },\r\n    [getTaskByTeacher.pending]: (state, action) => {\r\n      state.status = \"loading\";\r\n    },\r\n    [uploadFile.fulfilled]: (state, action) => {\r\n      state.statusUpload = \"yakhdem\";\r\n      state.files.push(action.payload);\r\n    },\r\n    [addUploadFile.fulfilled]: (state, action) => {\r\n      state.filesL.push(action.payload);\r\n    },\r\n    [DeleteResources.fulfilled]: (state, action) => {\r\n      let res = action.payload;\r\n      let resources = state.files.slice();\r\n      resources = resources.filter((u) => {\r\n        return u[0] !== res;\r\n      });\r\n      state.files = resources;\r\n    },\r\n    [getTaskByTeacher.fulfilled]: (state, { payload }) => {\r\n      state.tasks = payload;\r\n      state.status = \"success\";\r\n    },\r\n    [getTaskByTeacher.rejected]: (state, action) => {\r\n      state.status = \"failed\";\r\n    },\r\n    [getDetailTask.pending]: (state, action) => {\r\n      state.status = \"loading\";\r\n    },\r\n    [getDetailTask.fulfilled]: (state, { payload }) => {\r\n      state.tasks = payload;\r\n      state.status = \"success\";\r\n    },\r\n    [getDetailTask.rejected]: (state, action) => {\r\n      state.status = \"failed\";\r\n    },\r\n\r\n    postTasks: (state, action) => {\r\n      state.tasks.push(action.payload);\r\n    },\r\n    assignTask: (state, action) => {\r\n      state.tasks.push(action.payload);\r\n    },\r\n    [updateTask.pending]: (state, action) => {\r\n      state.status = \"loading\";\r\n    },\r\n    [updateTask.fulfilled]: (state, { payload }) => {\r\n      state.tasks = payload;\r\n    },\r\n    [updateTask.rejected]: (state, action) => {\r\n      state.status = \"failed\";\r\n    },\r\n    [updateTaskStatus.pending]: (state, action) => {\r\n      state.status = \"loading\";\r\n    },\r\n    [updateTaskStatus.fulfilled]: (state, { payload }) => {\r\n      state.tasks = payload;\r\n    },\r\n    [updateTaskStatus.rejected]: (state, action) => {\r\n      state.status = \"failed\";\r\n    },\r\n    [getNbrTasksRemis.pending]: (state, action) => {\r\n      state.status = \"loading\";\r\n    },\r\n    [getNbrTasksRemis.fulfilled]: (state, action) => {\r\n      if (action.payload.length > 0) state.nbrRemis = action.payload[0].count;\r\n    },\r\n    [getNbrTasksRemis.rejected]: (state, action) => {\r\n      state.status = \"failed\";\r\n    },\r\n    [getNbrTasksMissing.pending]: (state, action) => {\r\n      state.status = \"loading\";\r\n    },\r\n    [getNbrTasksMissing.fulfilled]: (state, action) => {\r\n      if (action.payload.length > 0) state.nbrMissing = action.payload[0].count;\r\n    },\r\n    [getNbrTasksMissing.rejected]: (state, action) => {\r\n      state.status = \"failed\";\r\n    },\r\n    [assignAfterSave.pending]: (state, action) => {\r\n      state.status = \"loading\";\r\n    },\r\n    [assignAfterSave.fulfilled]: (state, action) => {\r\n      state.tasks.push(action.payload);\r\n    },\r\n    [assignAfterSave.rejected]: (state, action) => {\r\n      state.status = \"failed\";\r\n    },\r\n  },\r\n});\r\n\r\nexport default taskSlice.reducer;\r\n"]},"metadata":{},"sourceType":"module"}