import{r as t,c as i,w as e,h as s,g as n}from"./p-f8abe418.js";import{o,w as h,m as r}from"./p-29b5bd7f.js";import{w as a}from"./p-cdfa9679.js";import"./p-0cbaf141.js";const m=class{constructor(e){t(this,e),this.vmOpen=i(this,"vmOpen",7),this.vmClose=i(this,"vmClose",7),this.vmFocus=i(this,"vmFocus",7),this.vmBlur=i(this,"vmBlur",7),this.vmActiveSubmenuChange=i(this,"vmActiveSubmenuChange",7),this.vmActiveMenuItemChange=i(this,"vmActiveMenuItemChange",7),this.vmMenuHeightChange=i(this,"vmMenuHeightChange",3),this.hasDisconnected=!1,this.active=!1,h(this)}onActiveMenuitemChange(){this.vmActiveMenuItemChange.emit(this.activeMenuItem)}onActiveSubmenuChange(){this.vmActiveSubmenuChange.emit(this.activeSubmenu)}onActiveChange(){this.hasDisconnected||(this.active?this.vmOpen.emit(this.host):this.vmClose.emit(this.host),"vm-menu-item"===this.controller?.tagName.toLowerCase()&&(this.controller.expanded=!0))}connectedCallback(){this.hasDisconnected=!1}componentDidRender(){e((()=>{this.hasDisconnected||this.calculateHeight()}))}disconnectedCallback(){this.controller=void 0,this.hasDisconnected=!0}async focusMenu(){this.menu?.focus()}async blurMenu(){this.menu?.blur()}async getActiveMenuItem(){return this.activeMenuItem}async setActiveMenuItem(t){t?.focusItem(),this.activeMenuItem=t}async calculateHeight(){let t=0;if(this.activeSubmenu){const i=await this.activeSubmenu.getMenu();t=await(i?.calculateHeight())??0,t+=await this.activeSubmenu.getControllerHeight()}else this.container?.firstChild.assignedElements({flatten:!0})?.forEach((i=>{t+=parseFloat(window.getComputedStyle(i).height)}));return this.vmMenuHeightChange.emit(t),t}onOpenSubmenu(t){t.stopPropagation(),o(this.activeSubmenu)||(this.activeSubmenu.active=!1),this.activeSubmenu=t.detail,this.getChildren().forEach((t=>{t!==this.activeSubmenu&&(t.style.opacity="0",t.style.visibility="hidden")})),e((()=>{this.activeSubmenu.active=!0}))}onCloseSubmenu(t){t?.stopPropagation(),o(this.activeSubmenu)||(this.activeSubmenu.active=!1),this.getChildren().forEach((t=>{t!==this.activeSubmenu&&(t.style.opacity="",t.style.visibility="")})),e((()=>{this.activeSubmenu=void 0}))}onWindowClick(){this.onCloseSubmenu(),this.onClose()}onWindowKeyDown(t){this.active&&"Escape"===t.key&&(this.onCloseSubmenu(),this.onClose(),this.focusController())}getChildren(){return this.host.shadowRoot.querySelector("slot")?.assignedElements({flatten:!0})??[]}getMenuItems(){return function(t){if(o(t))return[];const i=["vm-menu-item","vm-menu-radio-group","vm-submenu"];return Array.from(t??[]).filter((t=>i.includes(t.tagName.toLowerCase()))).map((t=>function(t){return"vm-submenu"!==t.tagName.toLowerCase()?t:t.shadowRoot.querySelector("vm-menu-item")}(t))).map((t=>function(t){if("vm-menu-radio-group"!==t.tagName.toLowerCase())return t;const i=t.shadowRoot.querySelector("slot");return Array.from(i?.assignedElements()??[]).filter((t=>"vm-menu-radio"===t.tagName.toLowerCase())).map((t=>t.shadowRoot.querySelector("vm-menu-item")))}(t))).reduce(((t,i)=>t.concat(i)),[])}(this.host.shadowRoot.querySelector("slot")?.assignedElements({flatten:!0}))}focusController(){o(this.controller?.focusItem)?o(this.controller?.focusControl)?this.controller?.focus():this.controller?.focusControl():this.controller?.focusItem()}triggerMenuItem(){o(this.activeMenuItem)||(this.activeMenuItem.click(),this.activeMenuItem.menu?.focusMenu())}onClose(){this.activeMenuItem=void 0,this.active=!1}onClick(t){t.stopPropagation()}onFocus(){this.active=!0,[this.activeMenuItem]=this.getMenuItems(),this.activeMenuItem?.focusItem(),this.vmFocus.emit()}onBlur(){this.vmBlur.emit()}foucsMenuItem(t,i){i<0&&(i=t.length-1),i>t.length-1&&(i=0),this.activeMenuItem=t[i],this.activeMenuItem.focusItem()}onKeyDown(t){if(!this.active)return;t.preventDefault(),t.stopPropagation();const i=this.getMenuItems();let e=i.findIndex((t=>t===this.activeMenuItem));switch(t.key){case"Escape":this.onClose(),this.focusController();break;case"ArrowDown":case"Tab":this.foucsMenuItem(i,e+=1);break;case"ArrowUp":this.foucsMenuItem(i,e-=1);break;case"ArrowLeft":this.onClose(),this.focusController();break;case"ArrowRight":case"Enter":case" ":this.triggerMenuItem();break;case"Home":case"PageUp":this.foucsMenuItem(i,0);break;case"End":case"PageDown":this.foucsMenuItem(i,i.length-1)}}render(){return s("div",{id:this.identifier,class:{menu:!0,slideIn:!o(this.slideInDirection),slideInFromLeft:"left"===this.slideInDirection,slideInFromRight:"right"===this.slideInDirection},role:"menu",tabindex:"-1","aria-labelledby":this.controller?.identifier??this.controller?.id,"aria-hidden":this.active?"false":"true",onFocus:this.onFocus.bind(this),onBlur:this.onBlur.bind(this),onClick:this.onClick.bind(this),onKeyDown:this.onKeyDown.bind(this),ref:t=>{this.menu=t}},s("div",{class:"container",ref:t=>{this.container=t}},s("slot",null)))}get host(){return n(this)}static get watchers(){return{activeMenuItem:["onActiveMenuitemChange"],activeSubmenu:["onActiveSubmenuChange"],active:["onActiveChange"]}}};m.style=":host{position:absolute;top:0;left:0;width:100%;height:100%;overflow:hidden;pointer-events:none;z-index:var(--vm-menu-z-index)}:host([active]){pointer-events:auto;z-index:calc(var(--vm-menu-z-index) + 1)}.menu{position:absolute;top:0;left:0;width:100%;height:100%;box-sizing:border-box;transition:var(--vm-menu-transition)}.menu.slideIn{transform:translateX(0)}.menu[aria-hidden='true'].slideInFromLeft{transform:translateX(-100%)}.menu[aria-hidden='true'].slideInFromRight{transform:translateX(100%)}.container{display:flex;flex-direction:column;position:relative;text-align:left;width:100%;height:100%;color:var(--vm-menu-color);background:var(--vm-menu-bg);font-size:var(--vm-menu-font-size);font-weight:var(--vm-menu-font-weight)}.menu:focus{outline:0}";const u=class{constructor(e){t(this,e),this.vmFocus=i(this,"vmFocus",7),this.vmBlur=i(this,"vmBlur",7),this.showTapHighlight=!1,this.hidden=!1,this.checkIcon="check",this.isTouch=!1,h(this),a(this,["isTouch"])}async focusItem(){this.menuItem?.focus()}async blurItem(){this.menuItem?.blur()}async getHeight(){return parseFloat(this.menuItem?window.getComputedStyle(this.menuItem).height:"0")}onClick(){r(this.menu)||(this.menu.active=!this.expanded)}onFocus(){this.vmFocus.emit()}onBlur(){this.vmBlur.emit()}onTouchStart(){this.showTapHighlight=!0}onTouchEnd(){setTimeout((()=>{this.showTapHighlight=!1}),100)}onMouseLeave(){this.menuItem?.blur()}render(){const t=!o(this.checked),i=!o(this.menu),e=this.expanded?"true":"false",n=this.checked?"true":"false",h=t&&!o(this.checkIcon),r=i&&this.expanded,a=i&&!this.expanded,m=!(o(this.hint)||t||i&&this.expanded),u=!o(this.badge)&&!m&&!a,c=m||a;return s("div",{class:{menuItem:!0,notTouch:!this.isTouch,tapHighlight:this.showTapHighlight,showDivider:i&&(this.expanded??!1)},id:this.identifier,role:t?"menuitemradio":"menuitem",tabindex:"0","aria-label":this.label,"aria-hidden":this.hidden?"true":"false","aria-haspopup":i?"true":void 0,"aria-controls":this.menu?.identifier??this.menu?.id,"aria-expanded":i?e:void 0,"aria-checked":t?n:void 0,onClick:this.onClick.bind(this),onFocus:this.onFocus.bind(this),onBlur:this.onBlur.bind(this),onTouchStart:this.onTouchStart.bind(this),onTouchEnd:this.onTouchEnd.bind(this),onMouseLeave:this.onMouseLeave.bind(this),ref:t=>{this.menuItem=t}},h&&s("vm-icon",{name:this.checkIcon,library:this.icons}),r&&s("span",{class:"arrow left"}),this.label,c&&s("span",{class:"spacer"}),m&&s("span",{class:"hint"},this.hint),u&&s("span",{class:"badge"},this.badge),a&&s("span",{class:"arrow right"}))}get host(){return n(this)}};u.style=":host{display:block}.menuItem{display:flex;position:relative;align-items:center;flex-direction:row;cursor:pointer;color:var(--vm-menu-color);background:var(--vm-menu-bg);font-size:var(--vm-menu-font-size);font-weight:var(--vm-menu-font-weight);padding:var(--vm-menu-item-padding);touch-action:manipulation;box-sizing:border-box}.menuItem:focus{outline:0}.menuItem.hidden{display:none}.menuItem.tapHighlight{background:var(--vm-menu-item-tap-highlight)}.menuItem.showDivider{border-bottom:0.5px solid var(--vm-menu-item-divider-color)}.menuItem.notTouch:hover,.menuItem.notTouch:focus{outline:0;color:var(--vm-menu-item-focus-color);background-color:var(--vm-menu-item-focus-bg)}.menuItem[aria-expanded='true']{position:absolute;z-index:2;top:0;width:100%}.menuItem[aria-hidden='true']{display:none}.menuItem[aria-checked='true'] vm-icon{opacity:1;visibility:visible}vm-icon{display:inline-block}vm-icon{fill:currentColor;pointer-events:none;font-size:var(--vm-menu-item-check-icon-size);margin-right:10px;opacity:0;visibility:hidden;transition:var(--vm-fade-transition)}.hint{display:inline-block;margin-left:auto;overflow:hidden;pointer-events:none;margin-right:6px;font-size:var(--vm-menu-item-hint-font-size);opacity:var(--vm-menu-item-hint-opacity);color:var(--vm-menu-item-hint-color)}.badge{display:inline-block;line-height:1;overflow:hidden;pointer-events:none;margin-left:6px;color:var(--vm-menu-item-badge-color);background:var(--vm-menu-item-badge-bg);font-size:var(--vm-menu-item-badge-font-size)}.spacer{flex:1}.arrow{color:var(--vm-menu-item-arrow-color);border:2px solid;padding:2px;display:inline-block;border-width:0 2px 2px 0}.arrow.left{margin-right:6px;transform:rotate(135deg)}.arrow.right{transform:rotate(-45deg);opacity:0.38}";export{m as vm_menu,u as vm_menu_item}