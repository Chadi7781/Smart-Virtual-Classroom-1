import{g as e,w as a}from"./p-f8abe418.js";import{a as t}from"./p-8acb8eb5.js";import{d as r,h as n,l as i,D as o}from"./p-29b5bd7f.js";import{P as c}from"./p-121aab6e.js";const s=a=>(t,n)=>{const i=r(a,HTMLElement)?a:e(a),o=new CustomEvent("vmProviderChange",{bubbles:!0,composed:!0,detail:{by:i,prop:t,value:n}});i.dispatchEvent(o)},d=new Set(["ready","playing","playbackReady","playbackStarted","playbackEnded","seeking","buffered","buffering","duration","viewType","mediaTitle","mediaType","currentSrc","currentPoster","playbackRates","playbackQualities","textTracks","currentTextTrack","isTextTrackVisible","audioTracks","currentAudioTrack","isPiPActive","isFullscreenActive"]),b=Symbol("vmProviderCache");function u(e,a){return new CustomEvent(e,{bubbles:!0,composed:!0,detail:a})}function p(r){const s=e(r),p=new o,m=new Map;function v(t){t.stopImmediatePropagation(),Object.keys(r).forEach((e=>{m.set(e,r[e])}));const i=t.detail,o=e(t.detail);if(r.provider===o)return;const d=o?.nodeName.toLowerCase().replace("vm-","");a((async()=>{r.provider=o,r.currentProvider=Object.values(c).find((e=>d===e)),n(i,void 0,(()=>{a((async()=>{r.ready=!1,r.provider=void 0,m.clear(),r.onProviderDisconnect?.(),s.dispatchEvent(u("vmMediaProviderDisconnect"))}))}))}))}function l(e){e.stopImmediatePropagation();const{by:n,prop:i,value:o}=e.detail;(e=>t(e)||d.has(e))(i)?a((()=>{m.set(i,o),r[i]=o})):r.logger?.warn(`${n.nodeName} tried to change \`${i}\` but it is readonly.`)}r[b]=m,n(r,(()=>{p.add(i(s,"vmMediaProviderConnect",v)),p.add(i(s,"vmProviderChange",l))}),(()=>{p.empty(),m.clear()}))}function m(a){const t=u("vmMediaProviderConnect",a);n(a,(()=>{e(a).dispatchEvent(t)}))}export{b as P,p as a,s as c,m as w}