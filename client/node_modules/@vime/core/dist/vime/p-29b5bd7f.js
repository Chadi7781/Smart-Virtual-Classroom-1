import{g as e}from"./p-f8abe418.js";const n=e=>null===e,t=e=>void 0===e,o=e=>n(e)||t(e),s=e=>o(e)?void 0:e.constructor,a=e=>s(e)===Object,r=e=>s(e)===Number&&!Number.isNaN(e),i=e=>s(e)===String,c=e=>s(e)===Boolean,m=e=>s(e)===Function,u=e=>Array.isArray(e),l=(e,n)=>Boolean(e&&n&&e instanceof n);function d(e,n,t,o){return e.addEventListener(n,t,o),()=>e.removeEventListener(n,t,o)}const v=(e,n,t=0,o=0,s=0,a=0)=>{const r=e.getBoundingClientRect(),i=n.getBoundingClientRect();return r.left+t<i.right+s&&r.right+t>i.left+s&&r.top+o<i.bottom+a&&r.bottom+o>i.top+a},f=()=>{let e,n;return{promise:new Promise(((t,o)=>{e=t,n=o})),resolve:e,reject:n}};function y(e,n,t){const o=e[n];e[n]=function(){return t(),o?o.call(e):void 0}}function b(e,n,o){let s=!1;t(n)||(y(e,"componentWillLoad",(()=>{n(),s=!0})),y(e,"connectedCallback",(()=>{s&&n()}))),t(o)||y(e,"disconnectedCallback",(()=>{o()}))}function p(n){const t=e(n);let o;b(n,(()=>{o=d(t,"vmFindPlayer",(e=>{e.stopPropagation(),e.detail(t)}))}),(()=>{o?.()}))}const C=(n,t=300,o=10)=>{const s=l(n,HTMLElement)?n:e(n),a=f();let r;const i=new CustomEvent("vmFindPlayer",{bubbles:!0,composed:!0,detail:e=>{a.resolve(e),r()}});return r=function(e,n,t,o=300,s=10){let a,r=0,i=!1;return function c(){i||(a=setTimeout((()=>{r!==s?(e.dispatchEvent(n),r+=1,c()):t?.()}),o))}(),()=>{window.clearTimeout(a),i=!0}}(s,i,(()=>{a.reject("Could not find player for "+s.nodeName)}),t,o),a.promise};class w{constructor(e=[]){this.dispose=e}add(e){this.dispose.push(e)}empty(){this.dispose.forEach((e=>e())),this.dispose=[]}}const g=Symbol("vmPlayerKey"),R=Symbol("vmNameKey"),E=Symbol("vmRegistryKey"),S=Symbol("vmRegistrationKey"),h=n=>l(n,HTMLElement)?n:e(n);function P(e,n){const t=Symbol("vmRegistryId"),o=h(e);o[R]=n??o.nodeName.toLowerCase(),o[S]=t;const s=new CustomEvent("vmComponentRegister",{bubbles:!0,composed:!0,detail:e});b(e,(()=>{o.dispatchEvent(s)}))}function j(n){const t=e(n),o=new Map,s=new w;function a(e){const n=e.detail,s=h(n);s[g]=t,s[E]=o,o.set(s[S],s),t.dispatchEvent(new CustomEvent("vmComponentRegistered",{detail:s})),b(n,void 0,(()=>function(e){delete e[g],delete e[E],o.delete(e[S]),t.dispatchEvent(new CustomEvent("vmComponentDeregistered",{detail:e}))}(s)))}t[E]=o,b(n,(()=>{s.add(d(t,"vmComponentRegister",a))}),(()=>{o.clear(),s.empty(),delete n[E]}))}function A(e,n){const t=h(e);return Array.from(t[E]?.values()??[]).some((e=>e[R]===n))}function K(e){return h(e)[g]}function k(e,n){const t=h(e);return Array.from(t[E]?.values()??[]).filter((e=>e[R]===n))}async function D(e,n,t){const o=await C(e),s=new w,a=h(e)[E];function r(e){e.detail[R]===n&&t?.(k(o,n))}return Array.from(a?.values()??[]).forEach((e=>r(new CustomEvent("",{detail:e})))),s.add(d(o,"vmComponentRegistered",r)),s.add(d(o,"vmComponentDeregistered",r)),b(e,(()=>{}),(()=>{s.empty()})),()=>{s.empty()}}export{R as C,w as D,g as P,E as R,S as a,D as b,k as c,l as d,i as e,C as f,K as g,b as h,A as i,f as j,a as k,d as l,o as m,u as n,t as o,m as p,y as q,p as r,j as s,r as t,c as u,n as v,P as w,v as x}