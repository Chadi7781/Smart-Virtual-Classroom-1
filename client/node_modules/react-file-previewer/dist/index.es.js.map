{"version":3,"file":"index.es.js","sources":["../src/utils/setZoomIn.js","../src/utils/setZoomOut.js","../src/utils/getFilename.js","../src/utils/getFileProp.js","../src/utils/setNewRotation.js","../src/utils/useViewportSize.js","../src/utils/getFitToScreenScale.js","../src/Button.js","../src/PageCount.js","../src/PreviewBarLeft.js","../src/PreviewBarRight.js","../src/PreviewBar.js","../src/ViewportControl.js","../src/utils/isPDF.js","../src/PDFViewer.js","../src/ImageViewer.js","../src/ViewportContent.js","../src/FilePreviewer.js","../src/FilePreviewerThumbnail.js"],"sourcesContent":["import * as R from 'ramda';\n\nconst SCALE_FACTOR = 0.25;\n\n/**\n * Scale the document by 25%.\n *\n * @param  {Object} files\n * @return {Object}\n */\nconst setZoomIn = R.converge(R.assoc('scale'), [\n  R.compose(\n    R.map(R.add(SCALE_FACTOR)),\n    R.when(R.is(Number), R.of),\n    R.propOr([1], 'scale'),\n  ),\n  R.identity,\n]);\n\nexport default setZoomIn;\n","import * as R from 'ramda';\n\nconst SCALE_FACTOR = 0.25;\n\n/**\n * Reduce the document scale by 25%.\n *\n * @param  {Object} files\n * @return {Object}\n */\nconst setZoomOut = R.converge(R.assoc('scale'), [\n  R.compose(\n    R.map(R.subtract(R.__, SCALE_FACTOR)),\n    R.when(R.is(Number), R.of),\n    R.propOr([1], 'scale'),\n  ),\n  R.identity,\n]);\n\nexport default setZoomOut;\n","import * as R from 'ramda';\nimport { extension } from 'mime-types';\n\nconst DEFAULT_NAME = 'download.pdf';\n\n/**\n * Get the name to download this file.\n *\n * @param  {Object} file\n * @return {String}\n */\nconst getFilename = R.cond([\n  [R.has('name'), R.prop('name')],\n  [R.has('mimeType'), R.o(extension, R.prop('mimeType'))],\n  [R.T, R.always(DEFAULT_NAME)],\n]);\n\nexport default getFilename;\n","import * as R from 'ramda';\n\n/**\n * Read the file `url`, in case it matches a base64 url.\n *\n * @param  {Object} file\n * @return {Object}\n */\nconst getFileDataInBase64 = R.compose(\n  R.prop('groups'),\n  R.match(/^data:(?<mimeType>[a-z]+\\/[a-z]+);base64,(?<data>.*)/),\n  R.propOr('', 'url'),\n);\n\n/**\n * Get the `file` from the properties, in the correct format.\n *\n * @param {Object} props\n */\nconst getFileProp = props => {\n  // Check if the file url is base64.\n  if (getFileDataInBase64(props.file)) {\n    // Update the file to include the data and mimeType extracted from the url.\n    return getFileDataInBase64(props.file);\n  }\n\n  return props.file;\n};\n\nexport default getFileProp;\n","import * as R from 'ramda';\n\n/**\n * Rotate the file 90 degrees.\n *\n * @param  {Object} files\n * @return {Object}\n */\nconst setNewRotation = R.converge(R.assoc('rotate'), [\n  R.compose(R.modulo(R.__, 360), R.add(90), R.propOr(0, 'rotate')),\n  R.identity,\n]);\n\nexport default setNewRotation;\n","import { pathOr } from 'ramda';\nimport { useState, useEffect } from 'react';\n\nconst useViewportSize = viewportElem => {\n  const isClient = typeof window === 'object';\n\n  const [size, setSize] = useState({\n    width: pathOr(0, ['current', 'clientWidth'], viewportElem),\n    height: pathOr(0, ['current', 'clientHeight'], viewportElem),\n  });\n\n  useEffect(() => {\n    setSize({\n      width: pathOr(0, ['current', 'clientWidth'], viewportElem),\n      height: pathOr(0, ['current', 'clientHeight'], viewportElem),\n    });\n  }, [viewportElem]);\n\n  useEffect(() => {\n    if (!isClient) {\n      return false;\n    }\n\n    function handleResize() {\n      setSize({\n        width: pathOr(0, ['current', 'clientWidth'], viewportElem),\n        height: pathOr(0, ['current', 'clientHeight'], viewportElem),\n      });\n    }\n\n    window.addEventListener('resize', handleResize);\n    return () => window.removeEventListener('resize', handleResize);\n  }, [viewportElem]);\n\n  return size;\n};\n\nexport default useViewportSize;\n","// Make sure to leave a padding.\nconst PADDING = 12 * 4;\n\n// Get the preview bar height.\nconst PREVIEW_BAR_HEIGHT = 52;\n\nconst getViewportWidth = viewportElem =>\n  viewportElem.width || viewportElem.clientWidth;\n\n/**\n * Get the viewport height, with its constraints.\n *\n * @param  {Object} viewportElem\n * @return {Number}\n */\nconst getViewportHeight = viewportElem =>\n  (viewportElem.height || viewportElem.clientHeight) -\n  PREVIEW_BAR_HEIGHT -\n  PADDING;\n\n/**\n * Get the `scale` attribute for the \"fit to screen\" option.\n *\n * @param  {Object} viewportElem\n * @param  {Object} contentElem\n * @return {Number}\n */\nexport const getFitToScreenScale = (viewportElem, contentElem) => {\n  // Get the viewport ratio.\n  const viewportWidth = getViewportWidth(viewportElem);\n  const viewportHeight = getViewportHeight(viewportElem);\n  const viewportRatio = viewportWidth / viewportHeight;\n\n  // Get the content ratio.\n  const contentWidth = contentElem.width || contentElem.offsetWidth;\n  const contentHeight = contentElem.height || contentElem.offsetHeight;\n  const contentRatio = contentWidth / contentHeight;\n\n  if (contentHeight > viewportHeight && contentWidth > viewportWidth) {\n    const heightRatio = viewportHeight / contentHeight;\n    const widthRatio = viewportWidth / contentWidth;\n\n    return Math.min(widthRatio, heightRatio);\n  }\n\n  if (contentHeight > viewportHeight) {\n    return viewportHeight / contentHeight;\n  }\n\n  if (contentWidth > viewportWidth) {\n    return viewportWidth / contentWidth;\n  }\n\n  // Get the scaling ratio in `0.25` steps.\n  return (\n    Math.round(\n      (viewportRatio > contentRatio\n        ? viewportHeight / contentHeight\n        : viewportWidth / contentWidth) * 4,\n    ) / 4\n  );\n};\n\n/**\n * Get the `scale` attribute for the \"fit to width\" option.\n *\n * @param  {Object} viewportElem\n * @param  {Object} contentElem\n * @return {Number}\n */\nexport const getFitToWidthScale = (viewportElem, contentElem) => {\n  // Get the viewport ratio.\n  const viewportWidth = getViewportWidth(viewportElem);\n\n  // Get the content ratio.\n  const contentWidth = contentElem.width || contentElem.offsetWidth;\n\n  // Get the scaling ratio, after removing the padding.\n  return (viewportWidth - PADDING) / contentWidth;\n};\n\nexport default getFitToWidthScale;\n","import React from 'react';\n\nconst Button = ({ children, onClick, disabled }) => (\n  <button\n    type=\"button\"\n    onClick={onClick}\n    disabled={disabled}\n    className=\"preview-button\"\n  >\n    {children}\n  </button>\n);\n\nexport default Button;\n","import React from 'react';\n\nconst PageCount = ({ current, total }) => (\n  <span className=\"preview-pagecount\">\n    {current + 1} of {total}\n  </span>\n);\n\nexport default PageCount;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport ChevronUp from 'mdi-material-ui/ChevronUp';\nimport ChevronDown from 'mdi-material-ui/ChevronDown';\n\nimport Button from './Button';\nimport PageCount from './PageCount';\n\nconst PreviewBarLeft = props => {\n  return (\n    <div className=\"preview-bar-left\">\n      {/* Page to go up means going back. */}\n      <Button onClick={props.onPageUp} disabled={props.currentPage === 0}>\n        <ChevronUp />\n      </Button>\n\n      {/* Page to go down means going next. */}\n      <Button\n        onClick={props.onPageDown}\n        disabled={props.currentPage + 1 === props.totalPages}\n      >\n        <ChevronDown />\n      </Button>\n\n      <PageCount current={props.currentPage} total={props.totalPages} />\n    </div>\n  );\n};\n\nPreviewBarLeft.propTypes = {\n  totalPages: PropTypes.number.isRequired,\n  currentPage: PropTypes.number.isRequired,\n  onPageUp: PropTypes.func.isRequired,\n  onPageDown: PropTypes.func.isRequired,\n};\n\nexport default PreviewBarLeft;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport Download from 'mdi-material-ui/Download';\nimport RotateRight from 'mdi-material-ui/RotateRight';\n\nimport Button from './Button';\n\nconst PreviewBarRight = props => (\n  <div className=\"preview-bar-left\">\n    <Button onClick={props.onRotate}>\n      <RotateRight />\n    </Button>\n\n    <Button onClick={props.onDownload}>\n      <Download />\n    </Button>\n  </div>\n);\n\nPreviewBarRight.propTypes = {\n  onRotate: PropTypes.func.isRequired,\n  onDownload: PropTypes.func.isRequired,\n};\n\nexport default PreviewBarRight;\n","import React from 'react';\nimport PropTypes from 'prop-types';\n\nimport PreviewBarLeft from './PreviewBarLeft';\nimport PreviewBarRight from './PreviewBarRight';\n\nconst PreviewBar = props => {\n  if (props.hidden) {\n    return null;\n  }\n\n  return (\n    <div className=\"preview-bar\">\n      <PreviewBarLeft\n        onPageUp={props.onPageUp}\n        onPageDown={props.onPageDown}\n        totalPages={props.totalPages}\n        currentPage={props.currentPage}\n      />\n\n      <PreviewBarRight\n        onRotate={props.onRotate}\n        onDownload={props.onDownload}\n      />\n    </div>\n  );\n};\n\nPreviewBar.propTypes = {\n  onPageUp: PropTypes.func.isRequired,\n  onRotate: PropTypes.func.isRequired,\n  onPageDown: PropTypes.func.isRequired,\n  onDownload: PropTypes.func.isRequired,\n  totalPages: PropTypes.number.isRequired,\n  currentPage: PropTypes.number.isRequired,\n  hidden: PropTypes.bool,\n};\n\nexport default PreviewBar;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport PlusBox from 'mdi-material-ui/PlusBox';\nimport MinusBox from 'mdi-material-ui/MinusBox';\nimport ArrowExpandHorizontal from 'mdi-material-ui/ArrowExpandHorizontal';\n\nimport Button from './Button';\n\nconst ViewportControl = props => {\n  if (props.hidden) {\n    return null;\n  }\n\n  return (\n    <div className=\"preview-icons\">\n      <Button onClick={props.onZoomIn}>\n        <PlusBox />\n      </Button>\n\n      <Button onClick={props.onZoomOut} className=\"preview-icons\">\n        <MinusBox />\n      </Button>\n\n      <Button onClick={props.onFitToScreen} className=\"preview-icons\">\n        <ArrowExpandHorizontal />\n      </Button>\n    </div>\n  );\n};\n\nViewportControl.propTypes = {\n  onZoomIn: PropTypes.func.isRequired,\n  onZoomOut: PropTypes.func.isRequired,\n  onFitToScreen: PropTypes.func.isRequired,\n  hidden: PropTypes.bool,\n};\n\nexport default ViewportControl;\n","import * as R from 'ramda';\n\n/**\n * Check if a file is a pdf.\n *\n * @param  {Object}\n * @return {Boolean}\n */\nconst isPDF = R.either(\n  R.o(R.endsWith('.pdf'), R.propOr('', 'url')),\n  R.propEq('mimeType', 'application/pdf'),\n);\n\nexport default isPDF;\n","import * as R from 'ramda';\nimport PropTypes from 'prop-types';\nimport React, { useEffect } from 'react';\nimport { Document, Page, pdfjs } from 'react-pdf';\nimport { useInView } from 'react-intersection-observer';\n\n// Get the pdf.js worker from cloudflare content delivery network.\npdfjs.GlobalWorkerOptions.workerSrc = `//cdnjs.cloudflare.com/ajax/libs/pdf.js/2.1.266/pdf.worker.js`;\n\nconst PDFPage = ({ index, onPageChange, scale = 1 }) => {\n  const [ref, inView] = useInView({ threshold: 0.5 });\n\n  useEffect(() => {\n    if (inView) onPageChange(index);\n  }, [inView]);\n\n  return (\n    <div ref={ref} className=\"preview-pdf-page\" data-pdfpage={index}>\n      <Page pageIndex={index} scale={scale} />\n    </div>\n  );\n};\n\nconst PDFViewer = ({ file, totalPages, onLoadSuccess, onPageChange }) => {\n  return (\n    <Document\n      rotate={file.rotate}\n      onLoadSuccess={onLoadSuccess}\n      file={file.url || `data:${file.mimeType};base64,${file.data}`}\n      options={{\n        cMapPacked: true,\n        cMapUrl: `//cdn.jsdelivr.net/npm/pdfjs-dist@${pdfjs.version}/cmaps/`,\n      }}\n    >\n      {R.times(\n        index => (\n          <PDFPage\n            key={index}\n            index={index}\n            onPageChange={onPageChange}\n            scale={Array.isArray(file.scale) ? file.scale[index] : file.scale}\n          />\n        ),\n        totalPages,\n      )}\n    </Document>\n  );\n};\n\nPDFViewer.propTypes = {\n  file: PropTypes.shape({\n    url: PropTypes.string,\n    data: PropTypes.string,\n    name: PropTypes.string,\n    mimeType: PropTypes.string,\n  }),\n  totalPages: PropTypes.number,\n  onPageChange: PropTypes.func.isRequired,\n  onLoadSuccess: PropTypes.func.isRequired,\n};\n\nexport default PDFViewer;\n","import PropTypes from 'prop-types';\nimport { propOr, pathOr } from 'ramda';\nimport React, { useState, useRef } from 'react';\n\n/**\n * Get the scale for this image.\n *\n * @param  {Object} file\n * @return {Number}\n */\nconst getScale = pathOr(1, ['scale', 0]);\n\n/**\n * Get the rotation for this image.\n *\n * @param  {Object} file\n * @return {Number}\n */\nconst getRotation = propOr(0, 'rotate');\n\nconst getResponseLikePDF = imgRef => {\n  const { clientWidth, clientHeight } = imgRef.current;\n\n  return {\n    numPages: 1,\n    getPage: () => ({\n      getViewport: () => ({\n        width: clientWidth,\n        height: clientHeight,\n      }),\n    }),\n  };\n};\n\n/**\n * `ImageViewer` react component.\n *\n * @param  {Object}   params\n * @param  {Object}   params.file\n * @param  {String}   params.file.url\n * @param  {String}   params.file.data\n * @param  {Array}    params.file.scale\n * @param  {Number}   params.file.rotate\n * @param  {String}   params.file.mimeType\n * @param  {Array}    params.originalSizes\n * @param  {Function} params.onLoadSuccess\n */\nconst ImageViewer = ({ file, originalSizes, onLoadSuccess }) => {\n  const imgRef = useRef(null);\n  const [isLoading, setLoading] = useState(true);\n\n  const onLoad = () => {\n    // Execute the callback.\n    onLoadSuccess(getResponseLikePDF(imgRef));\n\n    // Set the loading state to false.\n    setLoading(false);\n  };\n\n  const scaleImage =\n    !originalSizes[0] || !getScale(file)\n      ? {}\n      : {\n          width: originalSizes[0].width * getScale(file),\n          height: originalSizes[0].height * getScale(file),\n        };\n\n  return (\n    <img\n      ref={imgRef}\n      onLoad={onLoad}\n      src={file.url || `data:${file.mimeType};base64,${file.data}`}\n      style={{\n        ...scaleImage,\n        opacity: isLoading ? 0 : 1,\n        transform: `rotate(${getRotation(file)}deg)`,\n      }}\n    />\n  );\n};\n\nImageViewer.propTypes = {\n  file: PropTypes.shape({\n    url: PropTypes.string,\n    data: PropTypes.string,\n    scale: PropTypes.array,\n    rotate: PropTypes.number,\n    mimeType: PropTypes.string,\n  }),\n  originalSizes: PropTypes.array,\n  onLoadSuccess: PropTypes.func.isRequired,\n};\n\nexport default ImageViewer;\n","import React from 'react';\nimport PropTypes from 'prop-types';\n\nimport isPDF from './utils/isPDF';\nimport PDFViewer from './PDFViewer';\nimport ImageViewer from './ImageViewer';\n\nconst ViewportContent = ({\n  file,\n  totalPages,\n  containerRef,\n  onPageChange,\n  originalSizes,\n  onLoadSuccess,\n}) => (\n  <div ref={containerRef} className={'preview-content'}>\n    <div className=\"preview-file\">\n      {isPDF(file) ? (\n        <PDFViewer\n          file={file}\n          totalPages={totalPages}\n          onPageChange={onPageChange}\n          onLoadSuccess={onLoadSuccess}\n        />\n      ) : (\n        <ImageViewer\n          file={file}\n          onLoadSuccess={onLoadSuccess}\n          originalSizes={originalSizes}\n        />\n      )}\n    </div>\n  </div>\n);\n\nViewportContent.propTypes = {\n  file: PropTypes.shape({\n    url: PropTypes.string,\n    data: PropTypes.string,\n    name: PropTypes.string,\n    mimeType: PropTypes.string,\n  }),\n  totalPages: PropTypes.number,\n  onPageChange: PropTypes.func.isRequired,\n  onLoadSuccess: PropTypes.func.isRequired,\n};\n\nexport default ViewportContent;\n","import * as R from 'ramda';\nimport saveFile from 'file-saver';\nimport PropTypes from 'prop-types';\nimport React, { useEffect, useRef, useState } from 'react';\n\nimport setZoomIn from './utils/setZoomIn';\nimport setZoomOut from './utils/setZoomOut';\nimport getFilename from './utils/getFilename';\nimport getFileProp from './utils/getFileProp';\nimport setNewRotation from './utils/setNewRotation';\nimport useViewportSize from './utils/useViewportSize';\nimport getFitToScreenScale from './utils/getFitToScreenScale';\n\nimport PreviewBar from './PreviewBar';\nimport ViewportControl from './ViewportControl';\nimport ViewportContent from './ViewportContent';\n\n/**\n * `FilePreviewer` react component.\n *\n * @param  {Object}   props\n * @param  {Function} props.onClick\n * @param  {Object}   props.file\n * @param  {String}   props.file.url\n * @param  {String}   props.file.data\n * @param  {String}   props.file.name\n * @param  {String}   props.file.mimeType\n * @return {Object}\n */\nconst FilePreviewer = props => {\n  const [totalPages, setTotalPages] = useState(1);\n  const [currentPage, setCurrentPage] = useState(0);\n  const [file, setFile] = useState(getFileProp(props));\n  const [originalSizes, setOriginalSizes] = useState([]);\n  const [usingFitToScreen, setUsingFitToScreen] = useState(false);\n\n  const viewportRef = useRef(null);\n  const containerRef = useRef(null);\n  const viewportSize = useViewportSize(viewportRef);\n\n  useEffect(() => {\n    // Reset all the attributes when the file prop changes.\n    setTotalPages(1);\n    setCurrentPage(0);\n    setOriginalSizes([]);\n    setFile(getFileProp(props));\n  }, [props.file]);\n\n  /**\n   * Handler. Scroll to the pervious page and update the index.\n   *\n   * @return {void}\n   */\n  const onPageUp = () => {\n    const previousIndex = R.clamp(0, totalPages, currentPage - 1);\n\n    setCurrentPage(previousIndex);\n\n    const previousPage = document.querySelector(\n      `div[data-pdfpage=\"${previousIndex}\"]`,\n    );\n\n    // Scroll the viewport to the page position.\n    containerRef.current.scrollTop = previousPage.offsetTop - 10;\n  };\n\n  /**\n   * Handler. Scroll to the next page and update the index.\n   *\n   * @return {void}\n   */\n  const onPageDown = () => {\n    const nextIndex = R.clamp(0, totalPages, currentPage + 1);\n\n    setCurrentPage(nextIndex);\n\n    const nextPage = document.querySelector(`div[data-pdfpage=\"${nextIndex}\"]`);\n\n    // Scroll the viewport to the page position.\n    containerRef.current.scrollTop = nextPage.offsetTop - 10;\n  };\n\n  /**\n   * Handler. Scale all the pages or image\n   * up by a factor of 0.25.\n   *\n   * @return {void}\n   */\n  const onZoomIn = () => {\n    setUsingFitToScreen(false);\n    setFile(setZoomIn(file));\n  };\n\n  /**\n   * Handler. Scale all the pages or image\n   * down by a factor of 0.25.\n   *\n   * @return {void}\n   */\n  const onZoomOut = () => {\n    setUsingFitToScreen(false);\n    setFile(setZoomOut(file));\n  };\n\n  /**\n   * Handler. Rotate the PDF (all pages) or Image.\n   *\n   * @return {void}\n   */\n  const onRotate = () => {\n    setFile(setNewRotation(file));\n  };\n\n  /**\n   * Handler. Fit to screen.\n   *\n   * (This activates the \"using fit to screen\" mode, which\n   * makes the document or image resize based on the viewport size.)\n   *\n   * @return {void}\n   */\n  const onFitToScreen = () => {\n    setUsingFitToScreen(true);\n\n    // Get the \"fit to screen\" scale.\n    const newScale = originalSizes.map(originalSize =>\n      getFitToScreenScale(viewportSize, originalSize),\n    );\n\n    setFile(prevValue => R.assoc('scale', newScale, prevValue));\n  };\n\n  /**\n   * Handler. Download the current file, it can be a\n   * PDF or Image, as `url` or `base64` content.\n   *\n   * @return {void}\n   */\n  const onDownload = () => {\n    const url = file.url || `data:${file.mimeType};base64,${file.data}`;\n    return saveFile(url, getFilename(file));\n  };\n\n  /**\n   * Handler. Callback after the PDF gets\n   * processed successfully by `react-pdf`.\n   *\n   * @param  {Object} file\n   * @return {void}\n   */\n  const onLoadSuccess = file => {\n    // Wait until the original sizes gets calculated.\n    const promises = R.times(async i => {\n      // Wait until the original sizes gets calculated.\n      const page = await file.getPage(i + 1);\n      return R.pick(['width', 'height'], page.getViewport({ scale: 1 }));\n    }, file.numPages);\n\n    // Set the original sizes for this file.\n    Promise.all(promises).then(setOriginalSizes);\n\n    setTotalPages(file.numPages);\n    setUsingFitToScreen(true);\n  };\n\n  // Set an effect to process the file resizing when the\n  // viewport sizes changes and it's using \"fit to screen\".\n  useEffect(() => {\n    // Check if it's using \"fit to screen\".\n    if (usingFitToScreen) {\n      // Get the \"fit to screen\" scale.\n      const newScale = originalSizes.map(originalSize =>\n        getFitToScreenScale(viewportSize, originalSize),\n      );\n\n      // Update the scale.\n      setFile(prevValue => R.assoc('scale', newScale, prevValue));\n    }\n\n    return () => {};\n  }, [usingFitToScreen, originalSizes, viewportSize]);\n\n  return (\n    <div ref={viewportRef} onClick={props.onClick} className=\"preview-wrapper\">\n      <PreviewBar\n        onPageUp={onPageUp}\n        onRotate={onRotate}\n        totalPages={totalPages}\n        onDownload={onDownload}\n        onPageDown={onPageDown}\n        currentPage={currentPage}\n        hidden={props.hideControls}\n      />\n\n      <ViewportContent\n        file={file}\n        totalPages={totalPages}\n        containerRef={containerRef}\n        originalSizes={originalSizes}\n        onPageChange={setCurrentPage}\n        onLoadSuccess={onLoadSuccess}\n      />\n\n      <ViewportControl\n        onZoomIn={onZoomIn}\n        onZoomOut={onZoomOut}\n        onFitToScreen={onFitToScreen}\n        hidden={props.hideControls}\n      />\n    </div>\n  );\n};\n\nFilePreviewer.propTypes = {\n  file: PropTypes.shape({\n    url: PropTypes.string,\n    mimeType: PropTypes.string,\n    data: PropTypes.string,\n    name: PropTypes.string,\n  }).isRequired,\n  onClick: PropTypes.func,\n  hideControls: PropTypes.bool,\n};\n\nFilePreviewer.defaultProps = {\n  onClick: () => {},\n};\n\nexport default FilePreviewer;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Document, Page, pdfjs } from 'react-pdf';\n\nimport isPDF from './utils/isPDF';\nimport getFileProp from './utils/getFileProp';\n\nconst RenderPDF = ({ src }) => (\n  <Document\n    file={src}\n    options={{\n      cMapPacked: true,\n      cMapUrl: `//cdn.jsdelivr.net/npm/pdfjs-dist@${pdfjs.version}/cmaps/`,\n    }}\n  >\n    <Page pageNumber={1} width={80} height={85} />\n  </Document>\n);\n\n/**\n * `FilePreviewerThumbnail` react component.\n *\n * @param  {Object}   props\n * @param  {Object}   props.file\n * @param  {String}   props.file.url\n * @param  {String}   props.file.data\n * @param  {String}   props.file.mimeType\n * @param  {Function} props.onClick\n * @return {Object}\n */\nconst FilePreviewerThumbnail = props => {\n  const file = getFileProp(props);\n  const fileSrc = file.url || `data:${file.mimeType};base64,${file.data}`;\n\n  return (\n    <div\n      style={props.style}\n      onClick={props.onClick}\n      className=\"thumbnail-wrapper\"\n    >\n      {isPDF(file) ? <RenderPDF src={fileSrc} /> : <img src={fileSrc} />}\n    </div>\n  );\n};\n\nFilePreviewerThumbnail.propTypes = {\n  file: PropTypes.shape({\n    url: PropTypes.string,\n    mimeType: PropTypes.string,\n    data: PropTypes.string,\n  }).isRequired,\n  style: PropTypes.object,\n  onClick: PropTypes.func,\n};\n\nFilePreviewerThumbnail.defaultProps = {\n  style: {},\n  onClick: () => {},\n};\n\nexport default FilePreviewerThumbnail;\n"],"names":["SCALE_FACTOR","setZoomIn","R","Number","setZoomOut","DEFAULT_NAME","getFilename","extension","getFileDataInBase64","getFileProp","props","file","setNewRotation","useViewportSize","viewportElem","isClient","window","useState","width","pathOr","height","size","setSize","useEffect","handleResize","addEventListener","removeEventListener","PADDING","getViewportWidth","clientWidth","getFitToWidthScale","contentElem","viewportWidth","contentWidth","offsetWidth","Button","children","onClick","disabled","PageCount","current","total","PreviewBarLeft","onPageUp","currentPage","onPageDown","totalPages","propTypes","PropTypes","number","isRequired","func","PreviewBarRight","onRotate","onDownload","PreviewBar","hidden","bool","ViewportControl","onZoomIn","onZoomOut","onFitToScreen","isPDF","pdfjs","GlobalWorkerOptions","workerSrc","PDFPage","index","onPageChange","scale","useInView","threshold","ref","inView","PDFViewer","onLoadSuccess","rotate","url","mimeType","data","cMapPacked","cMapUrl","version","Array","isArray","shape","string","name","getScale","getRotation","propOr","getResponseLikePDF","imgRef","clientHeight","numPages","getPage","getViewport","ImageViewer","originalSizes","useRef","isLoading","setLoading","onLoad","scaleImage","opacity","transform","array","ViewportContent","containerRef","FilePreviewer","setTotalPages","setCurrentPage","setFile","setOriginalSizes","usingFitToScreen","setUsingFitToScreen","viewportRef","viewportSize","previousIndex","previousPage","document","querySelector","scrollTop","offsetTop","nextIndex","nextPage","newScale","map","originalSize","getFitToScreenScale","prevValue","saveFile","promises","i","page","Promise","all","then","hideControls","defaultProps","RenderPDF","src","FilePreviewerThumbnail","fileSrc","style","object"],"mappings":"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"}